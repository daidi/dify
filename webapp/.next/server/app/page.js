(() => {
var exports = {};
exports.id = 931;
exports.ids = [931];
exports.modules = {

/***/ 97783:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/@edge-runtime/cookies");

/***/ }),

/***/ 18038:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/react");

/***/ }),

/***/ 98704:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/react-dom/server-rendering-stub");

/***/ }),

/***/ 97897:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/react-server-dom-webpack/client");

/***/ }),

/***/ 56786:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/react/jsx-runtime");

/***/ }),

/***/ 61090:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/get-segment-param.js");

/***/ }),

/***/ 78652:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/future/helpers/interception-routes.js");

/***/ }),

/***/ 3280:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/app-router-context.js");

/***/ }),

/***/ 69274:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/hooks-client-context.js");

/***/ }),

/***/ 11751:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/add-path-prefix.js");

/***/ }),

/***/ 21668:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/handle-smooth-scroll.js");

/***/ }),

/***/ 1897:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/is-bot.js");

/***/ }),

/***/ 28854:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/parse-path.js");

/***/ }),

/***/ 93297:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/remove-trailing-slash.js");

/***/ }),

/***/ 3349:
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/server-inserted-html.js");

/***/ }),

/***/ 32081:
/***/ ((module) => {

"use strict";
module.exports = require("child_process");

/***/ }),

/***/ 6113:
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ 82361:
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ 57147:
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ 13685:
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ 95687:
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ 41808:
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ 22037:
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ 71017:
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ 77282:
/***/ ((module) => {

"use strict";
module.exports = require("process");

/***/ }),

/***/ 12781:
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ 24404:
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ 76224:
/***/ ((module) => {

"use strict";
module.exports = require("tty");

/***/ }),

/***/ 57310:
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ 73837:
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ 59796:
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ 20821:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "AppRouter": () => (/* reexport default from dynamic */ next_dist_client_components_app_router__WEBPACK_IMPORTED_MODULE_0___default.a),
/* harmony export */   "GlobalError": () => (/* reexport default from dynamic */ next_dist_client_components_error_boundary__WEBPACK_IMPORTED_MODULE_3___default.a),
/* harmony export */   "LayoutRouter": () => (/* reexport default from dynamic */ next_dist_client_components_layout_router__WEBPACK_IMPORTED_MODULE_1___default.a),
/* harmony export */   "RenderFromTemplateContext": () => (/* reexport default from dynamic */ next_dist_client_components_render_from_template_context__WEBPACK_IMPORTED_MODULE_2___default.a),
/* harmony export */   "StaticGenerationSearchParamsBailoutProvider": () => (/* reexport default from dynamic */ next_dist_client_components_static_generation_searchparams_bailout_provider__WEBPACK_IMPORTED_MODULE_8___default.a),
/* harmony export */   "__next_app_webpack_require__": () => (/* binding */ __next_app_webpack_require__),
/* harmony export */   "actionAsyncStorage": () => (/* reexport safe */ next_dist_client_components_action_async_storage__WEBPACK_IMPORTED_MODULE_6__.actionAsyncStorage),
/* harmony export */   "createSearchParamsBailoutProxy": () => (/* reexport safe */ next_dist_client_components_searchparams_bailout_proxy__WEBPACK_IMPORTED_MODULE_9__.createSearchParamsBailoutProxy),
/* harmony export */   "decodeAction": () => (/* reexport safe */ react_server_dom_webpack_server_edge__WEBPACK_IMPORTED_MODULE_11__.decodeAction),
/* harmony export */   "decodeReply": () => (/* reexport safe */ react_server_dom_webpack_server_edge__WEBPACK_IMPORTED_MODULE_11__.decodeReply),
/* harmony export */   "originalPathname": () => (/* binding */ originalPathname),
/* harmony export */   "pages": () => (/* binding */ pages),
/* harmony export */   "preconnect": () => (/* reexport safe */ next_dist_server_app_render_rsc_preloads__WEBPACK_IMPORTED_MODULE_12__.preconnect),
/* harmony export */   "preloadFont": () => (/* reexport safe */ next_dist_server_app_render_rsc_preloads__WEBPACK_IMPORTED_MODULE_12__.preloadFont),
/* harmony export */   "preloadStyle": () => (/* reexport safe */ next_dist_server_app_render_rsc_preloads__WEBPACK_IMPORTED_MODULE_12__.preloadStyle),
/* harmony export */   "renderToReadableStream": () => (/* reexport safe */ react_server_dom_webpack_server_edge__WEBPACK_IMPORTED_MODULE_11__.renderToReadableStream),
/* harmony export */   "requestAsyncStorage": () => (/* reexport safe */ next_dist_client_components_request_async_storage__WEBPACK_IMPORTED_MODULE_5__.requestAsyncStorage),
/* harmony export */   "serverHooks": () => (/* reexport module object */ next_dist_client_components_hooks_server_context__WEBPACK_IMPORTED_MODULE_10__),
/* harmony export */   "staticGenerationAsyncStorage": () => (/* reexport safe */ next_dist_client_components_static_generation_async_storage__WEBPACK_IMPORTED_MODULE_4__.staticGenerationAsyncStorage),
/* harmony export */   "staticGenerationBailout": () => (/* reexport safe */ next_dist_client_components_static_generation_bailout__WEBPACK_IMPORTED_MODULE_7__.staticGenerationBailout),
/* harmony export */   "tree": () => (/* binding */ tree)
/* harmony export */ });
/* harmony import */ var next_dist_client_components_app_router__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(18829);
/* harmony import */ var next_dist_client_components_app_router__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_client_components_app_router__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var next_dist_client_components_layout_router__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(45226);
/* harmony import */ var next_dist_client_components_layout_router__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_dist_client_components_layout_router__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var next_dist_client_components_render_from_template_context__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(42872);
/* harmony import */ var next_dist_client_components_render_from_template_context__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_client_components_render_from_template_context__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var next_dist_client_components_error_boundary__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(28412);
/* harmony import */ var next_dist_client_components_error_boundary__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_client_components_error_boundary__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var next_dist_client_components_static_generation_async_storage__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1839);
/* harmony import */ var next_dist_client_components_static_generation_async_storage__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_client_components_static_generation_async_storage__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var next_dist_client_components_request_async_storage__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(35120);
/* harmony import */ var next_dist_client_components_request_async_storage__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_client_components_request_async_storage__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var next_dist_client_components_action_async_storage__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(67797);
/* harmony import */ var next_dist_client_components_action_async_storage__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_client_components_action_async_storage__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var next_dist_client_components_static_generation_bailout__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(79282);
/* harmony import */ var next_dist_client_components_static_generation_bailout__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_client_components_static_generation_bailout__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var next_dist_client_components_static_generation_searchparams_bailout_provider__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(23785);
/* harmony import */ var next_dist_client_components_static_generation_searchparams_bailout_provider__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_client_components_static_generation_searchparams_bailout_provider__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var next_dist_client_components_searchparams_bailout_proxy__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(75183);
/* harmony import */ var next_dist_client_components_searchparams_bailout_proxy__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(next_dist_client_components_searchparams_bailout_proxy__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var next_dist_client_components_hooks_server_context__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(15815);
/* harmony import */ var next_dist_client_components_hooks_server_context__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(next_dist_client_components_hooks_server_context__WEBPACK_IMPORTED_MODULE_10__);
/* harmony import */ var react_server_dom_webpack_server_edge__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(76370);
/* harmony import */ var next_dist_server_app_render_rsc_preloads__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(50515);
/* harmony import */ var next_dist_server_app_render_rsc_preloads__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_app_render_rsc_preloads__WEBPACK_IMPORTED_MODULE_12__);

    const tree = {
        children: [
        '',
        {
        children: ['__PAGE__', {}, {
          page: [() => Promise.resolve(/* import() eager */).then(__webpack_require__.bind(__webpack_require__, 16594)), "C:\\Users\\Dorothy\\Documents\\GitHub\\dify\\webapp\\app\\page.tsx"],
          
        }]
      },
        {
          'layout': [() => Promise.resolve(/* import() eager */).then(__webpack_require__.bind(__webpack_require__, 70546)), "C:\\Users\\Dorothy\\Documents\\GitHub\\dify\\webapp\\app\\layout.tsx"],
          
        }
      ]
      }.children;
    const pages = ["C:\\Users\\Dorothy\\Documents\\GitHub\\dify\\webapp\\app\\page.tsx"];

    
    
    
    

    

    
    

    
    
    

    

    
    const __next_app_webpack_require__ = __webpack_require__
    
    
    const originalPathname = "/page"
  

/***/ }),

/***/ 48206:
/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {

Promise.resolve(/* import() eager */).then(__webpack_require__.bind(__webpack_require__, 41143))

/***/ }),

/***/ 85649:
/***/ (() => {



/***/ }),

/***/ 84403:
/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {

Promise.resolve(/* import() eager */).then(__webpack_require__.t.bind(__webpack_require__, 89222, 23));
Promise.resolve(/* import() eager */).then(__webpack_require__.t.bind(__webpack_require__, 78301, 23));
Promise.resolve(/* import() eager */).then(__webpack_require__.t.bind(__webpack_require__, 83751, 23));
Promise.resolve(/* import() eager */).then(__webpack_require__.t.bind(__webpack_require__, 54765, 23));
Promise.resolve(/* import() eager */).then(__webpack_require__.t.bind(__webpack_require__, 5192, 23))

/***/ }),

/***/ 41143:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ components)
});

// EXTERNAL MODULE: external "next/dist/compiled/react/jsx-runtime"
var jsx_runtime_ = __webpack_require__(56786);
// EXTERNAL MODULE: external "next/dist/compiled/react"
var react_ = __webpack_require__(18038);
var react_default = /*#__PURE__*/__webpack_require__.n(react_);
// EXTERNAL MODULE: ./node_modules/react-i18next/dist/es/index.js + 14 modules
var es = __webpack_require__(91148);
// EXTERNAL MODULE: ./node_modules/immer/dist/immer.esm.mjs
var immer_esm = __webpack_require__(46102);
// EXTERNAL MODULE: ./node_modules/ahooks/lib/index.js
var lib = __webpack_require__(97622);
;// CONCATENATED MODULE: ./hooks/use-conversation.ts



const storageConversationIdKey = "conversationIdInfo";
function useConversation() {
    const [conversationList, setConversationList] = (0,react_.useState)([]);
    const [currConversationId, doSetCurrConversationId, getCurrConversationId] = (0,lib/* useGetState */.$k)("-1");
    // when set conversation id, we do not have set appId
    const setCurrConversationId = (id, appId, isSetToLocalStroge = true, newConversationName = "")=>{
        doSetCurrConversationId(id);
        if (isSetToLocalStroge && id !== "-1") {
            // conversationIdInfo: {[appId1]: conversationId1, [appId2]: conversationId2}
            const conversationIdInfo = globalThis.localStorage?.getItem(storageConversationIdKey) ? JSON.parse(globalThis.localStorage?.getItem(storageConversationIdKey) || "") : {};
            conversationIdInfo[appId] = id;
            globalThis.localStorage?.setItem(storageConversationIdKey, JSON.stringify(conversationIdInfo));
        }
    };
    const getConversationIdFromStorage = (appId)=>{
        const conversationIdInfo = globalThis.localStorage?.getItem(storageConversationIdKey) ? JSON.parse(globalThis.localStorage?.getItem(storageConversationIdKey) || "") : {};
        const id = conversationIdInfo[appId];
        return id;
    };
    const isNewConversation = currConversationId === "-1";
    // input can be updated by user
    const [newConversationInputs, setNewConversationInputs] = (0,react_.useState)(null);
    const resetNewConversationInputs = ()=>{
        if (!newConversationInputs) return;
        setNewConversationInputs((0,immer_esm/* default */.ZP)(newConversationInputs, (draft)=>{
            Object.keys(draft).forEach((key)=>{
                draft[key] = "";
            });
        }));
    };
    const [existConversationInputs, setExistConversationInputs] = (0,react_.useState)(null);
    const currInputs = isNewConversation ? newConversationInputs : existConversationInputs;
    const setCurrInputs = isNewConversation ? setNewConversationInputs : setExistConversationInputs;
    // info is muted
    const [newConversationInfo, setNewConversationInfo] = (0,react_.useState)(null);
    const [existConversationInfo, setExistConversationInfo] = (0,react_.useState)(null);
    const currConversationInfo = isNewConversation ? newConversationInfo : existConversationInfo;
    return {
        conversationList,
        setConversationList,
        currConversationId,
        getCurrConversationId,
        setCurrConversationId,
        getConversationIdFromStorage,
        isNewConversation,
        currInputs,
        newConversationInputs,
        existConversationInputs,
        resetNewConversationInputs,
        setCurrInputs,
        currConversationInfo,
        setNewConversationInfo,
        setExistConversationInfo
    };
}
/* harmony default export */ const use_conversation = (useConversation);

// EXTERNAL MODULE: ./node_modules/classnames/index.js
var classnames = __webpack_require__(76071);
var classnames_default = /*#__PURE__*/__webpack_require__.n(classnames);
;// CONCATENATED MODULE: external "next/dist/compiled/react-dom/client"
const client_namespaceObject = require("next/dist/compiled/react-dom/client");
// EXTERNAL MODULE: ./node_modules/@heroicons/react/20/solid/esm/CheckCircleIcon.js
var CheckCircleIcon = __webpack_require__(19810);
// EXTERNAL MODULE: ./node_modules/@heroicons/react/20/solid/esm/XCircleIcon.js
var XCircleIcon = __webpack_require__(5194);
// EXTERNAL MODULE: ./node_modules/@heroicons/react/20/solid/esm/ExclamationTriangleIcon.js
var ExclamationTriangleIcon = __webpack_require__(70919);
// EXTERNAL MODULE: ./node_modules/@heroicons/react/20/solid/esm/InformationCircleIcon.js
var InformationCircleIcon = __webpack_require__(14749);
// EXTERNAL MODULE: ./node_modules/use-context-selector/dist/index.modern.mjs
var index_modern = __webpack_require__(45460);
;// CONCATENATED MODULE: ./app/components/base/toast/index.tsx
/* __next_internal_client_entry_do_not_use__ ToastContext,useToastContext,ToastProvider auto */ 





const defaultDuring = 3000;
const ToastContext = (0,index_modern/* createContext */.kr)({});
const useToastContext = ()=>useContext(ToastContext);
const Toast = ({ type ="info" , duration , message , children  })=>{
    // sometimes message is react node array. Not handle it.
    if (typeof message !== "string") return null;
    return /*#__PURE__*/ jsx_runtime_.jsx("div", {
        className: classnames_default()("fixed rounded-md p-4 my-4 mx-8 z-50", "top-0", "right-0", type === "success" ? "bg-green-50" : "", type === "error" ? "bg-red-50" : "", type === "warning" ? "bg-yellow-50" : "", type === "info" ? "bg-blue-50" : ""),
        children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
            className: "flex",
            children: [
                /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                    className: "flex-shrink-0",
                    children: [
                        type === "success" && /*#__PURE__*/ jsx_runtime_.jsx(CheckCircleIcon/* default */.Z, {
                            className: "w-5 h-5 text-green-400",
                            "aria-hidden": "true"
                        }),
                        type === "error" && /*#__PURE__*/ jsx_runtime_.jsx(XCircleIcon/* default */.Z, {
                            className: "w-5 h-5 text-red-400",
                            "aria-hidden": "true"
                        }),
                        type === "warning" && /*#__PURE__*/ jsx_runtime_.jsx(ExclamationTriangleIcon/* default */.Z, {
                            className: "w-5 h-5 text-yellow-400",
                            "aria-hidden": "true"
                        }),
                        type === "info" && /*#__PURE__*/ jsx_runtime_.jsx(InformationCircleIcon/* default */.Z, {
                            className: "w-5 h-5 text-blue-400",
                            "aria-hidden": "true"
                        })
                    ]
                }),
                /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                    className: "ml-3",
                    children: [
                        /*#__PURE__*/ jsx_runtime_.jsx("h3", {
                            className: classnames_default()("text-sm font-medium", type === "success" ? "text-green-800" : "", type === "error" ? "text-red-800" : "", type === "warning" ? "text-yellow-800" : "", type === "info" ? "text-blue-800" : ""),
                            children: message
                        }),
                        children && /*#__PURE__*/ jsx_runtime_.jsx("div", {
                            className: classnames_default()("mt-2 text-sm", type === "success" ? "text-green-700" : "", type === "error" ? "text-red-700" : "", type === "warning" ? "text-yellow-700" : "", type === "info" ? "text-blue-700" : ""),
                            children: children
                        })
                    ]
                })
            ]
        })
    });
};
const ToastProvider = ({ children  })=>{
    const placeholder = {
        type: "info",
        message: "Toast message",
        duration: 3000
    };
    const [params, setParams] = React.useState(placeholder);
    const [mounted, setMounted] = useState(false);
    useEffect(()=>{
        if (mounted) {
            setTimeout(()=>{
                setMounted(false);
            }, params.duration || defaultDuring);
        }
    }, [
        mounted
    ]);
    return /*#__PURE__*/ _jsxs(ToastContext.Provider, {
        value: {
            notify: (props)=>{
                setMounted(true);
                setParams(props);
            }
        },
        children: [
            mounted && /*#__PURE__*/ _jsx(Toast, {
                ...params
            }),
            children
        ]
    });
};
Toast.notify = ({ type , message , duration  })=>{
    if (false) {}
};
/* harmony default export */ const toast = (Toast);

// EXTERNAL MODULE: ./node_modules/@heroicons/react/24/outline/esm/PencilSquareIcon.js
var PencilSquareIcon = __webpack_require__(99560);
// EXTERNAL MODULE: ./node_modules/@heroicons/react/24/outline/esm/ChatBubbleOvalLeftEllipsisIcon.js
var ChatBubbleOvalLeftEllipsisIcon = __webpack_require__(76890);
// EXTERNAL MODULE: ./node_modules/@heroicons/react/24/solid/esm/ChatBubbleOvalLeftEllipsisIcon.js
var esm_ChatBubbleOvalLeftEllipsisIcon = __webpack_require__(98441);
;// CONCATENATED MODULE: ./app/components/base/spinner/index.tsx


const Spinner = ({ loading =false , children , className  })=>{
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: `inline-block text-gray-200 h-4 w-4 animate-spin rounded-full border-4 border-solid border-current border-r-transparent align-[-0.125em] ${loading ? "motion-reduce:animate-[spin_1.5s_linear_infinite]" : "hidden"} ${className ?? ""}`,
        role: "status",
        children: [
            /*#__PURE__*/ jsx_runtime_.jsx("span", {
                className: "!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]",
                children: "Loading..."
            }),
            children
        ]
    });
};
/* harmony default export */ const spinner = (Spinner);

;// CONCATENATED MODULE: ./app/components/base/button/index.tsx



const Button = ({ type , disabled , children , className , onClick , loading =false  })=>{
    let style = "cursor-pointer";
    switch(type){
        case "primary":
            style = disabled || loading ? "bg-primary-600/75 cursor-not-allowed text-white" : "bg-primary-600 hover:bg-primary-600/75 hover:shadow-md cursor-pointer text-white hover:shadow-sm";
            break;
        default:
            style = disabled ? "border-solid border border-gray-200 bg-gray-200 cursor-not-allowed text-gray-800" : "border-solid border border-gray-200 cursor-pointer text-gray-500 hover:bg-white hover:shadow-sm hover:border-gray-300";
            break;
    }
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: `flex justify-center items-center content-center h-9 leading-5 rounded-lg px-4 py-2 text-base ${style} ${className && className}`,
        onClick: disabled ? undefined : onClick,
        children: [
            children,
            /*#__PURE__*/ jsx_runtime_.jsx(spinner, {
                loading: loading,
                className: "!text-white !h-3 !w-3 !border-2 !ml-1"
            })
        ]
    });
};
/* harmony default export */ const base_button = (/*#__PURE__*/react_default().memo(Button));

;// CONCATENATED MODULE: ./app/components/sidebar/index.tsx






function sidebar_classNames(...classes) {
    return classes.filter(Boolean).join(" ");
}
const MAX_CONVERSATION_LENTH = 20;
const Sidebar = ({ copyRight , currentId , onCurrentIdChange , list  })=>{
    const { t  } = (0,es/* useTranslation */.$G)();
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: "shrink-0 flex flex-col overflow-y-auto bg-white pc:w-[244px] tablet:w-[192px] mobile:w-[240px]  border-r border-gray-200 tablet:h-[calc(100vh_-_3rem)] mobile:h-screen",
        children: [
            list.length < MAX_CONVERSATION_LENTH && /*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: "flex flex-shrink-0 p-4 !pb-0",
                children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)(base_button, {
                    onClick: ()=>{
                        onCurrentIdChange("-1");
                    },
                    className: "group block w-full flex-shrink-0 !justify-start !h-9 text-primary-600 items-center text-sm",
                    children: [
                        /*#__PURE__*/ jsx_runtime_.jsx(PencilSquareIcon/* default */.Z, {
                            className: "mr-2 h-4 w-4"
                        }),
                        " ",
                        t("app.chat.newChat")
                    ]
                })
            }),
            /*#__PURE__*/ jsx_runtime_.jsx("nav", {
                className: "mt-4 flex-1 space-y-1 bg-white p-4 !pt-0",
                children: list.map((item)=>{
                    const isCurrent = item.id === currentId;
                    const ItemIcon = isCurrent ? esm_ChatBubbleOvalLeftEllipsisIcon/* default */.Z : ChatBubbleOvalLeftEllipsisIcon/* default */.Z;
                    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                        onClick: ()=>onCurrentIdChange(item.id),
                        className: sidebar_classNames(isCurrent ? "bg-primary-50 text-primary-600" : "text-gray-700 hover:bg-gray-100 hover:text-gray-700", "group flex items-center rounded-md px-2 py-2 text-sm font-medium cursor-pointer"),
                        children: [
                            /*#__PURE__*/ jsx_runtime_.jsx(ItemIcon, {
                                className: sidebar_classNames(isCurrent ? "text-primary-600" : "text-gray-400 group-hover:text-gray-500", "mr-3 h-5 w-5 flex-shrink-0"),
                                "aria-hidden": "true"
                            }),
                            item.name
                        ]
                    }, item.id);
                })
            }),
            /*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: "flex flex-shrink-0 pr-4 pb-4 pl-4",
                children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                    className: "text-gray-400 font-normal text-xs",
                    children: [
                        "\xa9 ",
                        copyRight,
                        " ",
                        new Date().getFullYear()
                    ]
                })
            })
        ]
    });
};
/* harmony default export */ const sidebar = (/*#__PURE__*/react_default().memo(Sidebar));

// EXTERNAL MODULE: ./app/components/value-panel/style.module.css
var style_module = __webpack_require__(16269);
var style_module_default = /*#__PURE__*/__webpack_require__.n(style_module);
// EXTERNAL MODULE: ./node_modules/@heroicons/react/24/solid/esm/PencilIcon.js
var PencilIcon = __webpack_require__(8327);
// EXTERNAL MODULE: ./app/components/welcome/style.module.css
var welcome_style_module = __webpack_require__(11634);
var welcome_style_module_default = /*#__PURE__*/__webpack_require__.n(welcome_style_module);
;// CONCATENATED MODULE: ./app/components/welcome/massive-component.tsx
/* __next_internal_client_entry_do_not_use__ AppInfoComp,PromptTemplate,StarIcon,ChatBtn,EditBtn,FootLogo auto */ 






const AppInfoComp = ({ siteInfo  })=>{
    const { t  } = (0,es/* useTranslation */.$G)();
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        children: [
            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                className: "flex items-center py-2 text-xl font-medium text-gray-700 rounded-md",
                children: [
                    "\uD83D\uDC4F ",
                    t("app.common.welcome"),
                    " ",
                    siteInfo.title
                ]
            }),
            /*#__PURE__*/ jsx_runtime_.jsx("p", {
                className: "text-sm text-gray-500",
                children: siteInfo.description
            })
        ]
    });
};
const PromptTemplate = ({ html  })=>{
    return /*#__PURE__*/ jsx_runtime_.jsx("div", {
        className: " box-border text-sm text-gray-700",
        dangerouslySetInnerHTML: {
            __html: html
        }
    });
};
const StarIcon = ()=>/*#__PURE__*/ (0,jsx_runtime_.jsxs)("svg", {
        width: "12",
        height: "12",
        viewBox: "0 0 12 12",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        children: [
            /*#__PURE__*/ jsx_runtime_.jsx("path", {
                d: "M2.75 1C2.75 0.723858 2.52614 0.5 2.25 0.5C1.97386 0.5 1.75 0.723858 1.75 1V1.75H1C0.723858 1.75 0.5 1.97386 0.5 2.25C0.5 2.52614 0.723858 2.75 1 2.75H1.75V3.5C1.75 3.77614 1.97386 4 2.25 4C2.52614 4 2.75 3.77614 2.75 3.5V2.75H3.5C3.77614 2.75 4 2.52614 4 2.25C4 1.97386 3.77614 1.75 3.5 1.75H2.75V1Z",
                fill: "#444CE7"
            }),
            /*#__PURE__*/ jsx_runtime_.jsx("path", {
                d: "M2.75 8.5C2.75 8.22386 2.52614 8 2.25 8C1.97386 8 1.75 8.22386 1.75 8.5V9.25H1C0.723858 9.25 0.5 9.47386 0.5 9.75C0.5 10.0261 0.723858 10.25 1 10.25H1.75V11C1.75 11.2761 1.97386 11.5 2.25 11.5C2.52614 11.5 2.75 11.2761 2.75 11V10.25H3.5C3.77614 10.25 4 10.0261 4 9.75C4 9.47386 3.77614 9.25 3.5 9.25H2.75V8.5Z",
                fill: "#444CE7"
            }),
            /*#__PURE__*/ jsx_runtime_.jsx("path", {
                d: "M6.96667 1.32051C6.8924 1.12741 6.70689 1 6.5 1C6.29311 1 6.10759 1.12741 6.03333 1.32051L5.16624 3.57494C5.01604 3.96546 4.96884 4.078 4.90428 4.1688C4.8395 4.2599 4.7599 4.3395 4.6688 4.40428C4.578 4.46884 4.46546 4.51604 4.07494 4.66624L1.82051 5.53333C1.62741 5.60759 1.5 5.79311 1.5 6C1.5 6.20689 1.62741 6.39241 1.82051 6.46667L4.07494 7.33376C4.46546 7.48396 4.578 7.53116 4.6688 7.59572C4.7599 7.6605 4.8395 7.7401 4.90428 7.8312C4.96884 7.922 5.01604 8.03454 5.16624 8.42506L6.03333 10.6795C6.1076 10.8726 6.29311 11 6.5 11C6.70689 11 6.89241 10.8726 6.96667 10.6795L7.83376 8.42506C7.98396 8.03454 8.03116 7.922 8.09572 7.8312C8.1605 7.7401 8.2401 7.6605 8.3312 7.59572C8.422 7.53116 8.53454 7.48396 8.92506 7.33376L11.1795 6.46667C11.3726 6.39241 11.5 6.20689 11.5 6C11.5 5.79311 11.3726 5.60759 11.1795 5.53333L8.92506 4.66624C8.53454 4.51604 8.422 4.46884 8.3312 4.40428C8.2401 4.3395 8.1605 4.2599 8.09572 4.1688C8.03116 4.078 7.98396 3.96546 7.83376 3.57494L6.96667 1.32051Z",
                fill: "#444CE7"
            })
        ]
    });
const ChatBtn = ({ className , onClick  })=>{
    const { t  } = (0,es/* useTranslation */.$G)();
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)(base_button, {
        type: "primary",
        className: classnames_default()(className, `space-x-2 flex items-center ${(welcome_style_module_default()).customBtn}`),
        onClick: onClick,
        children: [
            /*#__PURE__*/ jsx_runtime_.jsx("svg", {
                width: "20",
                height: "21",
                viewBox: "0 0 20 21",
                fill: "none",
                xmlns: "http://www.w3.org/2000/svg",
                children: /*#__PURE__*/ jsx_runtime_.jsx("path", {
                    fillRule: "evenodd",
                    clipRule: "evenodd",
                    d: "M18 10.5C18 14.366 14.418 17.5 10 17.5C8.58005 17.506 7.17955 17.1698 5.917 16.52L2 17.5L3.338 14.377C2.493 13.267 2 11.934 2 10.5C2 6.634 5.582 3.5 10 3.5C14.418 3.5 18 6.634 18 10.5ZM7 9.5H5V11.5H7V9.5ZM15 9.5H13V11.5H15V9.5ZM9 9.5H11V11.5H9V9.5Z",
                    fill: "white"
                })
            }),
            t("app.chat.startChat")
        ]
    });
};
const EditBtn = ({ className , onClick  })=>{
    const { t  } = (0,es/* useTranslation */.$G)();
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: classnames_default()("px-2 flex space-x-1 items-center rounded-md  cursor-pointer", className),
        onClick: onClick,
        children: [
            /*#__PURE__*/ jsx_runtime_.jsx(PencilIcon/* default */.Z, {
                className: "w-3 h-3"
            }),
            /*#__PURE__*/ jsx_runtime_.jsx("span", {
                children: t("common.operation.edit")
            })
        ]
    });
};
const FootLogo = ()=>/*#__PURE__*/ jsx_runtime_.jsx("div", {
        className: (welcome_style_module_default()).logo
    });

;// CONCATENATED MODULE: ./app/components/value-panel/index.tsx
/* __next_internal_client_entry_do_not_use__ PanelTitle,VarOpBtnGroup auto */ 






const TemplateVarPanel = ({ className , header , children , isFold  })=>{
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: classnames_default()(isFold ? "border border-indigo-100" : (style_module_default()).boxShodow, className, "rounded-xl "),
        children: [
            /*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: classnames_default()(isFold && "rounded-b-xl", "rounded-t-xl px-6 py-4 bg-indigo-25 text-xs"),
                children: header
            }),
            !isFold && children && /*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: "rounded-b-xl p-6",
                children: children
            })
        ]
    });
};
const PanelTitle = ({ title , className  })=>{
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: classnames_default()(className, "flex items-center space-x-1 text-indigo-600"),
        children: [
            /*#__PURE__*/ jsx_runtime_.jsx(StarIcon, {}),
            /*#__PURE__*/ jsx_runtime_.jsx("span", {
                className: "text-xs",
                children: title
            })
        ]
    });
};
const VarOpBtnGroup = ({ className , onConfirm , onCancel  })=>{
    const { t  } = (0,es/* useTranslation */.$G)();
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: classnames_default()(className, "flex mt-3 space-x-2 mobile:ml-0 tablet:ml-[128px] text-sm"),
        children: [
            /*#__PURE__*/ jsx_runtime_.jsx(base_button, {
                className: "text-sm",
                type: "primary",
                onClick: onConfirm,
                children: t("common.operation.save")
            }),
            /*#__PURE__*/ jsx_runtime_.jsx(base_button, {
                className: "text-sm",
                onClick: onCancel,
                children: t("common.operation.cancel")
            })
        ]
    });
};
/* harmony default export */ const value_panel = (/*#__PURE__*/react_default().memo(TemplateVarPanel));

// EXTERNAL MODULE: ./node_modules/@headlessui/react/dist/components/combobox/combobox.js + 37 modules
var combobox = __webpack_require__(48068);
// EXTERNAL MODULE: ./node_modules/@heroicons/react/20/solid/esm/ChevronUpIcon.js
var ChevronUpIcon = __webpack_require__(68832);
// EXTERNAL MODULE: ./node_modules/@heroicons/react/20/solid/esm/ChevronDownIcon.js
var esm_ChevronDownIcon = __webpack_require__(63111);
// EXTERNAL MODULE: ./node_modules/@heroicons/react/20/solid/esm/CheckIcon.js
var esm_CheckIcon = __webpack_require__(97515);
;// CONCATENATED MODULE: ./app/components/base/select/index.tsx
/* __next_internal_client_entry_do_not_use__ SimpleSelect auto */ 




const defaultItems = [
    {
        value: 1,
        name: "option1"
    },
    {
        value: 2,
        name: "option2"
    },
    {
        value: 3,
        name: "option3"
    },
    {
        value: 4,
        name: "option4"
    },
    {
        value: 5,
        name: "option5"
    },
    {
        value: 6,
        name: "option6"
    },
    {
        value: 7,
        name: "option7"
    }
];
const Select = ({ className , items =defaultItems , defaultValue =1 , disabled =false , onSelect , allowSearch =true , bgClassName ="bg-gray-100"  })=>{
    const [query, setQuery] = (0,react_.useState)("");
    const [open, setOpen] = (0,react_.useState)(false);
    const [selectedItem, setSelectedItem] = (0,react_.useState)(null);
    (0,react_.useEffect)(()=>{
        let defaultSelect = null;
        const existed = items.find((item)=>item.value === defaultValue);
        if (existed) defaultSelect = existed;
        setSelectedItem(defaultSelect);
    }, [
        defaultValue
    ]);
    const filteredItems = query === "" ? items : items.filter((item)=>{
        return item.name.toLowerCase().includes(query.toLowerCase());
    });
    return /*#__PURE__*/ jsx_runtime_.jsx(combobox/* Combobox */.h, {
        as: "div",
        disabled: disabled,
        value: selectedItem,
        className: className,
        onChange: (value)=>{
            if (!disabled) {
                setSelectedItem(value);
                setOpen(false);
                onSelect(value);
            }
        },
        children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
            className: classnames_default()("relative"),
            children: [
                /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                    className: "group text-gray-800",
                    children: [
                        allowSearch ? /*#__PURE__*/ jsx_runtime_.jsx(combobox/* Combobox.Input */.h.Input, {
                            className: `w-full rounded-lg border-0 ${bgClassName} py-1.5 pl-3 pr-10 shadow-sm sm:text-sm sm:leading-6 focus-visible:outline-none focus-visible:bg-gray-200 group-hover:bg-gray-200 cursor-not-allowed`,
                            onChange: (event)=>{
                                if (!disabled) setQuery(event.target.value);
                            },
                            displayValue: (item)=>item?.name
                        }) : /*#__PURE__*/ jsx_runtime_.jsx(combobox/* Combobox.Button */.h.Button, {
                            onClick: ()=>{
                                if (!disabled) setOpen(!open);
                            },
                            className: `flex items-center h-9 w-full rounded-lg border-0 ${bgClassName} py-1.5 pl-3 pr-10 shadow-sm sm:text-sm sm:leading-6 focus-visible:outline-none focus-visible:bg-gray-200 group-hover:bg-gray-200`,
                            children: selectedItem?.name
                        }),
                        /*#__PURE__*/ jsx_runtime_.jsx(combobox/* Combobox.Button */.h.Button, {
                            className: "absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none group-hover:bg-gray-200",
                            onClick: ()=>{
                                if (!disabled) setOpen(!open);
                            },
                            children: open ? /*#__PURE__*/ jsx_runtime_.jsx(ChevronUpIcon/* default */.Z, {
                                className: "h-5 w-5"
                            }) : /*#__PURE__*/ jsx_runtime_.jsx(esm_ChevronDownIcon/* default */.Z, {
                                className: "h-5 w-5"
                            })
                        })
                    ]
                }),
                filteredItems.length > 0 && /*#__PURE__*/ jsx_runtime_.jsx(combobox/* Combobox.Options */.h.Options, {
                    className: "absolute z-10 mt-1 px-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg border-gray-200 border-[0.5px] focus:outline-none sm:text-sm",
                    children: filteredItems.map((item)=>/*#__PURE__*/ jsx_runtime_.jsx(combobox/* Combobox.Option */.h.Option, {
                            value: item,
                            className: ({ active  })=>classnames_default()("relative cursor-default select-none py-2 pl-3 pr-9 rounded-lg hover:bg-gray-100 text-gray-700", active ? "bg-gray-100" : ""),
                            children: ({ selected  })=>/*#__PURE__*/ (0,jsx_runtime_.jsxs)(jsx_runtime_.Fragment, {
                                    children: [
                                        /*#__PURE__*/ jsx_runtime_.jsx("span", {
                                            className: classnames_default()("block truncate", selected && "font-normal"),
                                            children: item.name
                                        }),
                                        selected && /*#__PURE__*/ jsx_runtime_.jsx("span", {
                                            className: classnames_default()("absolute inset-y-0 right-0 flex items-center pr-4 text-gray-700"),
                                            children: /*#__PURE__*/ jsx_runtime_.jsx(esm_CheckIcon/* default */.Z, {
                                                className: "h-5 w-5",
                                                "aria-hidden": "true"
                                            })
                                        })
                                    ]
                                })
                        }, item.value))
                })
            ]
        })
    });
};
const SimpleSelect = ({ className , items =defaultItems , defaultValue =1 , disabled =false , onSelect  })=>{
    const [selectedItem, setSelectedItem] = useState(null);
    useEffect(()=>{
        let defaultSelect = null;
        const existed = items.find((item)=>item.value === defaultValue);
        if (existed) defaultSelect = existed;
        setSelectedItem(defaultSelect);
    }, [
        defaultValue
    ]);
    return /*#__PURE__*/ _jsx(Listbox, {
        value: selectedItem,
        onChange: (value)=>{
            if (!disabled) {
                setSelectedItem(value);
                onSelect(value);
            }
        },
        children: /*#__PURE__*/ _jsxs("div", {
            className: "relative h-9",
            children: [
                /*#__PURE__*/ _jsxs(Listbox.Button, {
                    className: `w-full h-full rounded-lg border-0 bg-gray-100 py-1.5 pl-3 pr-10 shadow-sm sm:text-sm sm:leading-6 focus-visible:outline-none focus-visible:bg-gray-200 group-hover:bg-gray-200 cursor-pointer ${className}`,
                    children: [
                        /*#__PURE__*/ _jsx("span", {
                            className: "block truncate text-left",
                            children: selectedItem?.name
                        }),
                        /*#__PURE__*/ _jsx("span", {
                            className: "pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",
                            children: /*#__PURE__*/ _jsx(ChevronDownIcon, {
                                className: "h-5 w-5 text-gray-400",
                                "aria-hidden": "true"
                            })
                        })
                    ]
                }),
                /*#__PURE__*/ _jsx(Transition, {
                    as: Fragment,
                    leave: "transition ease-in duration-100",
                    leaveFrom: "opacity-100",
                    leaveTo: "opacity-0",
                    children: /*#__PURE__*/ _jsx(Listbox.Options, {
                        className: "absolute z-10 mt-1 px-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg border-gray-200 border-[0.5px] focus:outline-none sm:text-sm",
                        children: items.map((item)=>/*#__PURE__*/ _jsx(Listbox.Option, {
                                className: ({ active  })=>`relative cursor-pointer select-none py-2 pl-3 pr-9 rounded-lg hover:bg-gray-100 text-gray-700 ${active ? "bg-gray-100" : ""}`,
                                value: item,
                                disabled: disabled,
                                children: ({ selected  })=>/*#__PURE__*/ _jsxs(_Fragment, {
                                        children: [
                                            /*#__PURE__*/ _jsx("span", {
                                                className: classNames("block truncate", selected && "font-normal"),
                                                children: item.name
                                            }),
                                            selected && /*#__PURE__*/ _jsx("span", {
                                                className: classNames("absolute inset-y-0 right-0 flex items-center pr-4 text-gray-700"),
                                                children: /*#__PURE__*/ _jsx(CheckIcon, {
                                                    className: "h-5 w-5",
                                                    "aria-hidden": "true"
                                                })
                                            })
                                        ]
                                    })
                            }, item.value))
                    })
                })
            ]
        })
    });
};

/* harmony default export */ const base_select = (/*#__PURE__*/react_default().memo(Select));

;// CONCATENATED MODULE: ./config/index.ts
const APP_ID = `${"516ef55a-7741-4892-a008-b16b536aab71"}`;
const API_KEY = `${"app-uYnAtUj2Nhkh5wph8p6Ih43A"}`;
const API_URL = (/* unused pure expression or super */ null && (`${"https://api.idomy.cn/v1"}`));
const APP_INFO = {
    title: "Chat APP",
    description: "",
    copyright: "",
    privacy_policy: "",
    default_language: "zh-Hans"
};
const isShowPrompt = false;
const promptTemplate = "I want you to act as a javascript console.";
const API_PREFIX = "/api";
const config_LOCALE_COOKIE_NAME = "locale";
const DEFAULT_VALUE_MAX_LEN = 48;

;// CONCATENATED MODULE: ./app/components/welcome/index.tsx
/* __next_internal_client_entry_do_not_use__  auto */ 








// regex to match the {{}} and replace it with a span
const regex = /\{\{([^}]+)\}\}/g;
const Welcome = ({ conversationName , hasSetInputs , isPublicVersion , siteInfo , promptConfig , onStartChat , canEidtInpus , savedInputs , onInputsChange  })=>{
    const { t  } = (0,es/* useTranslation */.$G)();
    const hasVar = promptConfig.prompt_variables.length > 0;
    const [isFold, setIsFold] = (0,react_.useState)(true);
    const [inputs, setInputs] = (0,react_.useState)((()=>{
        if (hasSetInputs) return savedInputs;
        const res = {};
        if (promptConfig) {
            promptConfig.prompt_variables.forEach((item)=>{
                res[item.key] = "";
            });
        }
        return res;
    })());
    (0,react_.useEffect)(()=>{
        if (!savedInputs) {
            const res = {};
            if (promptConfig) {
                promptConfig.prompt_variables.forEach((item)=>{
                    res[item.key] = "";
                });
            }
            setInputs(res);
        } else {
            setInputs(savedInputs);
        }
    }, [
        savedInputs
    ]);
    const highLightPromoptTemplate = (()=>{
        if (!promptConfig) return "";
        const res = promptConfig.prompt_template.replace(regex, (match, p1)=>{
            return `<span class='text-gray-800 font-bold'>${inputs?.[p1] ? inputs?.[p1] : match}</span>`;
        });
        return res;
    })();
    const { notify  } = toast;
    const logError = (message)=>{
        notify({
            type: "error",
            message,
            duration: 3000
        });
    };
    const renderHeader = ()=>{
        return /*#__PURE__*/ jsx_runtime_.jsx("div", {
            className: "absolute top-0 left-0 right-0 flex items-center justify-between border-b border-gray-100 mobile:h-12 tablet:h-16 px-8 bg-white",
            children: /*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: "text-gray-900",
                children: conversationName
            })
        });
    };
    const renderInputs = ()=>{
        return /*#__PURE__*/ jsx_runtime_.jsx("div", {
            className: "space-y-3",
            children: promptConfig.prompt_variables.map((item)=>/*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                    className: "tablet:flex items-start mobile:space-y-2 tablet:space-y-0 mobile:text-xs tablet:text-sm",
                    children: [
                        /*#__PURE__*/ jsx_runtime_.jsx("label", {
                            className: `flex-shrink-0 flex items-center tablet:leading-9 mobile:text-gray-700 tablet:text-gray-900 mobile:font-medium pc:font-normal ${(welcome_style_module_default()).formLabel}`,
                            children: item.name
                        }),
                        item.type === "select" && /*#__PURE__*/ jsx_runtime_.jsx(base_select, {
                            className: "w-full",
                            defaultValue: inputs?.[item.key],
                            onSelect: (i)=>{
                                setInputs({
                                    ...inputs,
                                    [item.key]: i.value
                                });
                            },
                            items: (item.options || []).map((i)=>({
                                    name: i,
                                    value: i
                                })),
                            allowSearch: false,
                            bgClassName: "bg-gray-50"
                        }),
                        item.type === "string" && /*#__PURE__*/ jsx_runtime_.jsx("input", {
                            placeholder: `${item.name}${!item.required ? `(${t("appDebug.variableTable.optional")})` : ""}`,
                            value: inputs?.[item.key] || "",
                            onChange: (e)=>{
                                setInputs({
                                    ...inputs,
                                    [item.key]: e.target.value
                                });
                            },
                            className: "w-full flex-grow py-2 pl-3 pr-3 box-border rounded-lg bg-gray-50",
                            maxLength: item.max_length || DEFAULT_VALUE_MAX_LEN
                        }),
                        item.type === "paragraph" && /*#__PURE__*/ jsx_runtime_.jsx("textarea", {
                            className: "w-full h-[104px] flex-grow py-2 pl-3 pr-3 box-border rounded-lg bg-gray-50",
                            placeholder: `${item.name}${!item.required ? `(${t("appDebug.variableTable.optional")})` : ""}`,
                            value: inputs?.[item.key] || "",
                            onChange: (e)=>{
                                setInputs({
                                    ...inputs,
                                    [item.key]: e.target.value
                                });
                            }
                        })
                    ]
                }, item.key))
        });
    };
    const canChat = ()=>{
        const inputLens = Object.values(inputs).length;
        const promptVariablesLens = promptConfig.prompt_variables.length;
        const emytyInput = inputLens < promptVariablesLens || Object.values(inputs).filter((v)=>v === "").length > 0;
        if (emytyInput) {
            logError(t("app.errorMessage.valueOfVarRequired"));
            return false;
        }
        return true;
    };
    const handleChat = ()=>{
        if (!canChat()) return;
        onStartChat(inputs);
    };
    const renderNoVarPanel = ()=>{
        if (isPublicVersion) {
            return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                children: [
                    /*#__PURE__*/ jsx_runtime_.jsx(AppInfoComp, {
                        siteInfo: siteInfo
                    }),
                    /*#__PURE__*/ jsx_runtime_.jsx(value_panel, {
                        isFold: false,
                        header: /*#__PURE__*/ (0,jsx_runtime_.jsxs)(jsx_runtime_.Fragment, {
                            children: [
                                /*#__PURE__*/ jsx_runtime_.jsx(PanelTitle, {
                                    title: t("app.chat.publicPromptConfigTitle"),
                                    className: "mb-1"
                                }),
                                /*#__PURE__*/ jsx_runtime_.jsx(PromptTemplate, {
                                    html: highLightPromoptTemplate
                                })
                            ]
                        }),
                        children: /*#__PURE__*/ jsx_runtime_.jsx(ChatBtn, {
                            onClick: handleChat
                        })
                    })
                ]
            });
        }
        // private version
        return /*#__PURE__*/ jsx_runtime_.jsx(value_panel, {
            isFold: false,
            header: /*#__PURE__*/ jsx_runtime_.jsx(AppInfoComp, {
                siteInfo: siteInfo
            }),
            children: /*#__PURE__*/ jsx_runtime_.jsx(ChatBtn, {
                onClick: handleChat
            })
        });
    };
    const renderVarPanel = ()=>{
        return /*#__PURE__*/ (0,jsx_runtime_.jsxs)(value_panel, {
            isFold: false,
            header: /*#__PURE__*/ jsx_runtime_.jsx(AppInfoComp, {
                siteInfo: siteInfo
            }),
            children: [
                renderInputs(),
                /*#__PURE__*/ jsx_runtime_.jsx(ChatBtn, {
                    className: "mt-3 mobile:ml-0 tablet:ml-[128px]",
                    onClick: handleChat
                })
            ]
        });
    };
    const renderVarOpBtnGroup = ()=>{
        return /*#__PURE__*/ jsx_runtime_.jsx(VarOpBtnGroup, {
            onConfirm: ()=>{
                if (!canChat()) return;
                onInputsChange(inputs);
                setIsFold(true);
            },
            onCancel: ()=>{
                setInputs(savedInputs);
                setIsFold(true);
            }
        });
    };
    const renderHasSetInputsPublic = ()=>{
        if (!canEidtInpus) {
            return /*#__PURE__*/ jsx_runtime_.jsx(value_panel, {
                isFold: false,
                header: /*#__PURE__*/ (0,jsx_runtime_.jsxs)(jsx_runtime_.Fragment, {
                    children: [
                        /*#__PURE__*/ jsx_runtime_.jsx(PanelTitle, {
                            title: t("app.chat.publicPromptConfigTitle"),
                            className: "mb-1"
                        }),
                        /*#__PURE__*/ jsx_runtime_.jsx(PromptTemplate, {
                            html: highLightPromoptTemplate
                        })
                    ]
                })
            });
        }
        return /*#__PURE__*/ (0,jsx_runtime_.jsxs)(value_panel, {
            isFold: isFold,
            header: /*#__PURE__*/ (0,jsx_runtime_.jsxs)(jsx_runtime_.Fragment, {
                children: [
                    /*#__PURE__*/ jsx_runtime_.jsx(PanelTitle, {
                        title: t("app.chat.publicPromptConfigTitle"),
                        className: "mb-1"
                    }),
                    /*#__PURE__*/ jsx_runtime_.jsx(PromptTemplate, {
                        html: highLightPromoptTemplate
                    }),
                    isFold && /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                        className: "flex items-center justify-between mt-3 border-t border-indigo-100 pt-4 text-xs text-indigo-600",
                        children: [
                            /*#__PURE__*/ jsx_runtime_.jsx("span", {
                                className: "text-gray-700",
                                children: t("app.chat.configStatusDes")
                            }),
                            /*#__PURE__*/ jsx_runtime_.jsx(EditBtn, {
                                onClick: ()=>setIsFold(false)
                            })
                        ]
                    })
                ]
            }),
            children: [
                renderInputs(),
                renderVarOpBtnGroup()
            ]
        });
    };
    const renderHasSetInputsPrivate = ()=>{
        if (!canEidtInpus || !hasVar) return null;
        return /*#__PURE__*/ (0,jsx_runtime_.jsxs)(value_panel, {
            isFold: isFold,
            header: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                className: "flex items-center justify-between text-indigo-600",
                children: [
                    /*#__PURE__*/ jsx_runtime_.jsx(PanelTitle, {
                        title: !isFold ? t("app.chat.privatePromptConfigTitle") : t("app.chat.configStatusDes")
                    }),
                    isFold && /*#__PURE__*/ jsx_runtime_.jsx(EditBtn, {
                        onClick: ()=>setIsFold(false)
                    })
                ]
            }),
            children: [
                renderInputs(),
                renderVarOpBtnGroup()
            ]
        });
    };
    const renderHasSetInputs = ()=>{
        if (!isPublicVersion && !canEidtInpus || !hasVar) return null;
        return /*#__PURE__*/ jsx_runtime_.jsx("div", {
            className: "pt-[88px] mb-5",
            children: isPublicVersion ? renderHasSetInputsPublic() : renderHasSetInputsPrivate()
        });
    };
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: "relative mobile:min-h-[48px] tablet:min-h-[64px]",
        children: [
            hasSetInputs && renderHeader(),
            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                className: "mx-auto pc:w-[794px] max-w-full mobile:w-full px-3.5",
                children: [
                    !hasSetInputs && /*#__PURE__*/ jsx_runtime_.jsx("div", {
                        className: "mobile:pt-[72px] tablet:pt-[128px] pc:pt-[200px]",
                        children: hasVar ? renderVarPanel() : renderNoVarPanel()
                    }),
                    hasSetInputs && renderHasSetInputs(),
                    !hasSetInputs && /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                        className: "mt-4 flex justify-between items-center h-8 text-xs text-gray-400",
                        children: [
                            siteInfo.privacy_policy ? /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                children: [
                                    t("app.chat.privacyPolicyLeft"),
                                    /*#__PURE__*/ jsx_runtime_.jsx("a", {
                                        className: "text-gray-500",
                                        href: siteInfo.privacy_policy,
                                        target: "_blank",
                                        children: t("app.chat.privacyPolicyMiddle")
                                    }),
                                    t("app.chat.privacyPolicyRight")
                                ]
                            }) : /*#__PURE__*/ jsx_runtime_.jsx("div", {}),
                            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("a", {
                                className: "flex items-center pr-3 space-x-3",
                                href: "https://dify.ai/",
                                target: "_blank",
                                children: [
                                    /*#__PURE__*/ jsx_runtime_.jsx("span", {
                                        className: "uppercase",
                                        children: t("app.chat.powerBy")
                                    }),
                                    /*#__PURE__*/ jsx_runtime_.jsx(FootLogo, {})
                                ]
                            })
                        ]
                    })
                ]
            })
        ]
    });
};
/* harmony default export */ const welcome = (/*#__PURE__*/react_default().memo(Welcome));

;// CONCATENATED MODULE: ./app/components/config-scence/index.tsx



const ConfigSence = (props)=>{
    return /*#__PURE__*/ jsx_runtime_.jsx("div", {
        className: "mb-5 antialiased font-sans overflow-hidden shrink-0",
        children: /*#__PURE__*/ jsx_runtime_.jsx(welcome, {
            ...props
        })
    });
};
/* harmony default export */ const config_scence = (/*#__PURE__*/react_default().memo(ConfigSence));

// EXTERNAL MODULE: ./node_modules/@heroicons/react/24/solid/esm/Bars3Icon.js
var Bars3Icon = __webpack_require__(48511);
// EXTERNAL MODULE: ./node_modules/@heroicons/react/24/solid/esm/PencilSquareIcon.js
var esm_PencilSquareIcon = __webpack_require__(80063);
// EXTERNAL MODULE: ./app/components/base/app-icon/style.module.css
var app_icon_style_module = __webpack_require__(89322);
var app_icon_style_module_default = /*#__PURE__*/__webpack_require__.n(app_icon_style_module);
;// CONCATENATED MODULE: ./app/components/base/app-icon/index.tsx



const AppIcon = ({ size ="medium" , rounded =false , background , className  })=>{
    return /*#__PURE__*/ jsx_runtime_.jsx("span", {
        className: classnames_default()((app_icon_style_module_default()).appIcon, size !== "medium" && (app_icon_style_module_default())[size], rounded && (app_icon_style_module_default()).rounded, className ?? ""),
        style: {
            background
        },
        children: "\uD83E\uDD16"
    });
};
/* harmony default export */ const app_icon = (AppIcon);

;// CONCATENATED MODULE: ./app/components/header.tsx




const Header = ({ title , isMobile , onShowSideBar , onCreateNewChat  })=>{
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: "shrink-0 flex items-center justify-between h-12 px-3 bg-gray-100",
        children: [
            isMobile ? /*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: "flex items-center justify-center h-8 w-8 cursor-pointer",
                onClick: ()=>onShowSideBar?.(),
                children: /*#__PURE__*/ jsx_runtime_.jsx(Bars3Icon/* default */.Z, {
                    className: "h-4 w-4 text-gray-500"
                })
            }) : /*#__PURE__*/ jsx_runtime_.jsx("div", {}),
            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                className: "flex items-center space-x-2",
                children: [
                    /*#__PURE__*/ jsx_runtime_.jsx(app_icon, {
                        size: "small"
                    }),
                    /*#__PURE__*/ jsx_runtime_.jsx("div", {
                        className: " text-sm text-gray-800 font-bold",
                        children: title
                    })
                ]
            }),
            isMobile ? /*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: "flex items-center justify-center h-8 w-8 cursor-pointer",
                onClick: ()=>onCreateNewChat?.(),
                children: /*#__PURE__*/ jsx_runtime_.jsx(esm_PencilSquareIcon/* default */.Z, {
                    className: "h-4 w-4 text-gray-500"
                })
            }) : /*#__PURE__*/ jsx_runtime_.jsx("div", {})
        ]
    });
};
/* harmony default export */ const header = (/*#__PURE__*/react_default().memo(Header));

;// CONCATENATED MODULE: ./service/base.ts


const TIME_OUT = 100000;
const ContentType = {
    json: "application/json",
    stream: "text/event-stream",
    form: "application/x-www-form-urlencoded; charset=UTF-8",
    download: "application/octet-stream"
};
const baseOptions = {
    method: "GET",
    mode: "cors",
    credentials: "include",
    headers: new Headers({
        "Content-Type": ContentType.json
    }),
    redirect: "follow"
};
function unicodeToChar(text) {
    return text.replace(/\\u[0-9a-f]{4}/g, (_match, p1)=>{
        return String.fromCharCode(parseInt(p1, 16));
    });
}
const handleStream = (response, onData, onCompleted, onThought, onMessageEnd, onMessageReplace, onFile)=>{
    if (!response.ok) throw new Error("Network response was not ok");
    const reader = response.body?.getReader();
    const decoder = new TextDecoder("utf-8");
    let buffer = "";
    let bufferObj;
    let isFirstMessage = true;
    function read() {
        let hasError = false;
        reader?.read().then((result)=>{
            if (result.done) {
                onCompleted && onCompleted();
                return;
            }
            buffer += decoder.decode(result.value, {
                stream: true
            });
            const lines = buffer.split("\n");
            try {
                lines.forEach((message)=>{
                    if (message.startsWith("data: ")) {
                        try {
                            bufferObj = JSON.parse(message.substring(6));
                        // remove data: and parse as json
                        } catch (e) {
                            // mute handle message cut off
                            onData("", isFirstMessage, {
                                conversationId: bufferObj?.conversation_id,
                                messageId: bufferObj?.message_id
                            });
                            return;
                        }
                        if (bufferObj.status === 400 || !bufferObj.event) {
                            onData("", false, {
                                conversationId: undefined,
                                messageId: "",
                                errorMessage: bufferObj?.message,
                                errorCode: bufferObj?.code
                            });
                            hasError = true;
                            onCompleted?.(true);
                            return;
                        }
                        if (bufferObj.event === "message" || bufferObj.event === "agent_message") {
                            // can not use format here. Because message is splited.
                            onData(unicodeToChar(bufferObj.answer), isFirstMessage, {
                                conversationId: bufferObj.conversation_id,
                                taskId: bufferObj.task_id,
                                messageId: bufferObj.id
                            });
                            isFirstMessage = false;
                        } else if (bufferObj.event === "agent_thought") {
                            onThought?.(bufferObj);
                        } else if (bufferObj.event === "message_file") {
                            onFile?.(bufferObj);
                        } else if (bufferObj.event === "message_end") {
                            onMessageEnd?.(bufferObj);
                        } else if (bufferObj.event === "message_replace") {
                            onMessageReplace?.(bufferObj);
                        }
                    }
                });
                buffer = lines[lines.length - 1];
            } catch (e) {
                onData("", false, {
                    conversationId: undefined,
                    messageId: "",
                    errorMessage: `${e}`
                });
                hasError = true;
                onCompleted?.(true);
                return;
            }
            if (!hasError) read();
        });
    }
    read();
};
const baseFetch = (url, fetchOptions, { needAllResponseContent  })=>{
    const options = Object.assign({}, baseOptions, fetchOptions);
    const urlPrefix = API_PREFIX;
    let urlWithPrefix = `${urlPrefix}${url.startsWith("/") ? url : `/${url}`}`;
    const { method , params , body  } = options;
    // handle query
    if (method === "GET" && params) {
        const paramsArray = [];
        Object.keys(params).forEach((key)=>paramsArray.push(`${key}=${encodeURIComponent(params[key])}`));
        if (urlWithPrefix.search(/\?/) === -1) urlWithPrefix += `?${paramsArray.join("&")}`;
        else urlWithPrefix += `&${paramsArray.join("&")}`;
        delete options.params;
    }
    if (body) options.body = JSON.stringify(body);
    // Handle timeout
    return Promise.race([
        new Promise((resolve, reject)=>{
            setTimeout(()=>{
                reject(new Error("request timeout"));
            }, TIME_OUT);
        }),
        new Promise((resolve, reject)=>{
            globalThis.fetch(urlWithPrefix, options).then((res)=>{
                const resClone = res.clone();
                // Error handler
                if (!/^(2|3)\d{2}$/.test(res.status)) {
                    try {
                        const bodyJson = res.json();
                        switch(res.status){
                            case 401:
                                {
                                    toast.notify({
                                        type: "error",
                                        message: "Invalid token"
                                    });
                                    return;
                                }
                            default:
                                // eslint-disable-next-line no-new
                                new Promise(()=>{
                                    bodyJson.then((data)=>{
                                        toast.notify({
                                            type: "error",
                                            message: data.message
                                        });
                                    });
                                });
                        }
                    } catch (e) {
                        toast.notify({
                            type: "error",
                            message: `${e}`
                        });
                    }
                    return Promise.reject(resClone);
                }
                // handle delete api. Delete api not return content.
                if (res.status === 204) {
                    resolve({
                        result: "success"
                    });
                    return;
                }
                // return data
                const data = options.headers.get("Content-type") === ContentType.download ? res.blob() : res.json();
                resolve(needAllResponseContent ? resClone : data);
            }).catch((err)=>{
                toast.notify({
                    type: "error",
                    message: err
                });
                reject(err);
            });
        })
    ]);
};
const upload = (fetchOptions)=>{
    const urlPrefix = API_PREFIX;
    const urlWithPrefix = `${urlPrefix}/file-upload`;
    const defaultOptions = {
        method: "POST",
        url: `${urlWithPrefix}`,
        data: {}
    };
    const options = {
        ...defaultOptions,
        ...fetchOptions
    };
    return new Promise((resolve, reject)=>{
        const xhr = options.xhr;
        xhr.open(options.method, options.url);
        for(const key in options.headers)xhr.setRequestHeader(key, options.headers[key]);
        xhr.withCredentials = true;
        xhr.onreadystatechange = function() {
            if (xhr.readyState === 4) {
                if (xhr.status === 200) resolve({
                    id: xhr.response
                });
                else reject(xhr);
            }
        };
        xhr.upload.onprogress = options.onprogress;
        xhr.send(options.data);
    });
};
const ssePost = (url, fetchOptions, { onData , onCompleted , onThought , onFile , onMessageEnd , onMessageReplace , onError  })=>{
    const options = Object.assign({}, baseOptions, {
        method: "POST"
    }, fetchOptions);
    const urlPrefix = API_PREFIX;
    const urlWithPrefix = `${urlPrefix}${url.startsWith("/") ? url : `/${url}`}`;
    const { body  } = options;
    if (body) options.body = JSON.stringify(body);
    globalThis.fetch(urlWithPrefix, options).then((res)=>{
        if (!/^(2|3)\d{2}$/.test(res.status)) {
            // eslint-disable-next-line no-new
            new Promise(()=>{
                res.json().then((data)=>{
                    toast.notify({
                        type: "error",
                        message: data.message || "Server Error"
                    });
                });
            });
            onError?.("Server Error");
            return;
        }
        return handleStream(res, (str, isFirstMessage, moreInfo)=>{
            if (moreInfo.errorMessage) {
                toast.notify({
                    type: "error",
                    message: moreInfo.errorMessage
                });
                return;
            }
            onData?.(str, isFirstMessage, moreInfo);
        }, ()=>{
            onCompleted?.();
        }, onThought, onMessageEnd, onMessageReplace, onFile);
    }).catch((e)=>{
        toast.notify({
            type: "error",
            message: e
        });
        onError?.(e);
    });
};
const request = (url, options = {}, otherOptions)=>{
    return baseFetch(url, options, otherOptions || {});
};
const get = (url, options = {}, otherOptions)=>{
    return request(url, Object.assign({}, options, {
        method: "GET"
    }), otherOptions);
};
const post = (url, options = {}, otherOptions)=>{
    return request(url, Object.assign({}, options, {
        method: "POST"
    }), otherOptions);
};
const put = (url, options = {}, otherOptions)=>{
    return request(url, Object.assign({}, options, {
        method: "PUT"
    }), otherOptions);
};
const del = (url, options = {}, otherOptions)=>{
    return request(url, Object.assign({}, options, {
        method: "DELETE"
    }), otherOptions);
};

;// CONCATENATED MODULE: ./service/index.ts

const sendChatMessage = async (body, { onData , onCompleted , onThought , onFile , onError , getAbortController , onMessageEnd , onMessageReplace  })=>{
    return ssePost("chat-messages", {
        body: {
            ...body,
            response_mode: "streaming"
        }
    }, {
        onData,
        onCompleted,
        onThought,
        onFile,
        onError,
        getAbortController,
        onMessageEnd,
        onMessageReplace
    });
};
const fetchConversations = async ()=>{
    return get("conversations", {
        params: {
            limit: 100,
            first_id: ""
        }
    });
};
const fetchChatList = async (conversationId)=>{
    return get("messages", {
        params: {
            conversation_id: conversationId,
            limit: 20,
            last_id: ""
        }
    });
};
// init value. wait for server update
const fetchAppParams = async ()=>{
    return get("parameters");
};
const updateFeedback = async ({ url , body  })=>{
    return post(url, {
        body
    });
};
const generationConversationName = async (id)=>{
    return post(`conversations/${id}/name`, {
        body: {
            auto_generate: true
        }
    });
};

;// CONCATENATED MODULE: ./types/app.ts
const MessageRatings = (/* unused pure expression or super */ null && ([
    "like",
    "dislike",
    null
]));
var Resolution;
(function(Resolution) {
    Resolution["low"] = "low";
    Resolution["high"] = "high";
})(Resolution || (Resolution = {}));
var TransferMethod;
(function(TransferMethod) {
    TransferMethod["all"] = "all";
    TransferMethod["local_file"] = "local_file";
    TransferMethod["remote_url"] = "remote_url";
})(TransferMethod || (TransferMethod = {}));

// EXTERNAL MODULE: ./node_modules/rc-textarea/lib/index.js
var rc_textarea_lib = __webpack_require__(89943);
// EXTERNAL MODULE: ./node_modules/socket.io-client/build/esm-debug/index.js + 27 modules
var esm_debug = __webpack_require__(53133);
// EXTERNAL MODULE: ./app/components/chat/style.module.css
var chat_style_module = __webpack_require__(20190);
var chat_style_module_default = /*#__PURE__*/__webpack_require__.n(chat_style_module);
// EXTERNAL MODULE: ./node_modules/@heroicons/react/24/outline/esm/HandThumbUpIcon.js
var HandThumbUpIcon = __webpack_require__(43608);
// EXTERNAL MODULE: ./node_modules/@heroicons/react/24/outline/esm/HandThumbDownIcon.js
var HandThumbDownIcon = __webpack_require__(71447);
// EXTERNAL MODULE: ./app/components/chat/loading-anim/style.module.css
var loading_anim_style_module = __webpack_require__(51898);
var loading_anim_style_module_default = /*#__PURE__*/__webpack_require__.n(loading_anim_style_module);
;// CONCATENATED MODULE: ./app/components/chat/loading-anim/index.tsx
/* __next_internal_client_entry_do_not_use__  auto */ 


const LoaidingAnim = ({ type  })=>{
    return /*#__PURE__*/ jsx_runtime_.jsx("div", {
        className: `${(loading_anim_style_module_default())["dot-flashing"]} ${(loading_anim_style_module_default())[type]}`
    });
};
/* harmony default export */ const loading_anim = (/*#__PURE__*/react_default().memo(LoaidingAnim));

// EXTERNAL MODULE: ./app/components/base/image-gallery/style.module.css
var image_gallery_style_module = __webpack_require__(22749);
var image_gallery_style_module_default = /*#__PURE__*/__webpack_require__.n(image_gallery_style_module);
// EXTERNAL MODULE: external "next/dist/compiled/react-dom/server-rendering-stub"
var server_rendering_stub_ = __webpack_require__(98704);
;// CONCATENATED MODULE: ./app/components/base/icons/line/x-close/data.json
const data_namespaceObject = JSON.parse('{"icon":{"type":"element","isRootNode":true,"name":"svg","attributes":{"width":"16","height":"16","viewBox":"0 0 16 16","fill":"none","xmlns":"http://www.w3.org/2000/svg"},"children":[{"type":"element","name":"g","attributes":{"id":"x-close"},"children":[{"type":"element","name":"path","attributes":{"id":"Icon","d":"M12 4L4 12M4 4L12 12","stroke":"currentColor","stroke-width":"1.25","stroke-linecap":"round","stroke-linejoin":"round"},"children":[]}]}]},"name":"XClose"}');
;// CONCATENATED MODULE: ./app/components/base/icons/utils.tsx

function normalizeAttrs(attrs = {}) {
    return Object.keys(attrs).reduce((acc, key)=>{
        const val = attrs[key];
        key = key.replace(/([-]\w)/g, (g)=>g[1].toUpperCase());
        key = key.replace(/([:]\w)/g, (g)=>g[1].toUpperCase());
        switch(key){
            case "class":
                acc.className = val;
                delete acc.class;
                break;
            case "style":
                acc.style = val.split(";").reduce((prev, next)=>{
                    const pairs = next?.split(":");
                    if (pairs[0] && pairs[1]) {
                        const k = pairs[0].replace(/([-]\w)/g, (g)=>g[1].toUpperCase());
                        prev[k] = pairs[1];
                    }
                    return prev;
                }, {});
                break;
            default:
                acc[key] = val;
        }
        return acc;
    }, {});
}
function generate(node, key, rootProps) {
    if (!rootProps) {
        return /*#__PURE__*/ react_default().createElement(node.name, {
            key,
            ...normalizeAttrs(node.attributes)
        }, (node.children || []).map((child, index)=>generate(child, `${key}-${node.name}-${index}`)));
    }
    return /*#__PURE__*/ react_default().createElement(node.name, {
        key,
        ...normalizeAttrs(node.attributes),
        ...rootProps
    }, (node.children || []).map((child, index)=>generate(child, `${key}-${node.name}-${index}`)));
}

;// CONCATENATED MODULE: ./app/components/base/icons/IconBase.tsx


const IconBase = /*#__PURE__*/ (0,react_.forwardRef)((props, ref)=>{
    const { data , className , onClick , style , ...restProps } = props;
    return generate(data.icon, `svg-${data.name}`, {
        className,
        onClick,
        style,
        "data-icon": data.name,
        "aria-hidden": "true",
        ...restProps,
        "ref": ref
    });
});
/* harmony default export */ const icons_IconBase = (IconBase);

;// CONCATENATED MODULE: ./app/components/base/icons/line/x-close/index.tsx




const Icon = /*#__PURE__*/ react_.forwardRef((props, ref)=>/*#__PURE__*/ jsx_runtime_.jsx(icons_IconBase, {
        ...props,
        ref: ref,
        data: data_namespaceObject
    }));
Icon.displayName = "XClose";
/* harmony default export */ const x_close = (Icon);

;// CONCATENATED MODULE: ./app/components/base/image-uploader/image-preview.tsx



const ImagePreview = ({ url , onCancel  })=>{
    return /*#__PURE__*/ (0,server_rendering_stub_.createPortal)(/*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: "fixed inset-0 p-8 flex items-center justify-center bg-black/80 z-[1000]",
        onClick: (e)=>e.stopPropagation(),
        children: [
            /*#__PURE__*/ jsx_runtime_.jsx("img", {
                alt: "preview image",
                src: url,
                className: "max-w-full max-h-full"
            }),
            /*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: "absolute top-6 right-6 flex items-center justify-center w-8 h-8 bg-white/[0.08] rounded-lg backdrop-blur-[2px] cursor-pointer",
                onClick: onCancel,
                children: /*#__PURE__*/ jsx_runtime_.jsx(x_close, {
                    className: "w-4 h-4 text-white"
                })
            })
        ]
    }), document.body);
};
/* harmony default export */ const image_preview = (ImagePreview);

;// CONCATENATED MODULE: ./app/components/base/image-gallery/index.tsx
/* __next_internal_client_entry_do_not_use__ ImageGalleryTest auto */ 




const getWidthStyle = (imgNum)=>{
    if (imgNum === 1) {
        return {
            maxWidth: "100%"
        };
    }
    if (imgNum === 2 || imgNum === 4) {
        return {
            width: "calc(50% - 4px)"
        };
    }
    return {
        width: "calc(33.3333% - 5.3333px)"
    };
};
const ImageGallery = ({ srcs  })=>{
    const [imagePreviewUrl, setImagePreviewUrl] = (0,react_.useState)("");
    const imgNum = srcs.length;
    const imgStyle = getWidthStyle(imgNum);
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: classnames_default()((image_gallery_style_module_default())[`img-${imgNum}`], "flex flex-wrap"),
        children: [
            srcs.map((src, index)=>/*#__PURE__*/ jsx_runtime_.jsx("img", {
                    className: (image_gallery_style_module_default()).item,
                    style: imgStyle,
                    src: src,
                    alt: "",
                    onClick: ()=>setImagePreviewUrl(src)
                }, index)),
            imagePreviewUrl && /*#__PURE__*/ jsx_runtime_.jsx(image_preview, {
                url: imagePreviewUrl,
                onCancel: ()=>setImagePreviewUrl("")
            })
        ]
    });
};
/* harmony default export */ const image_gallery = (/*#__PURE__*/react_default().memo(ImageGallery));
const ImageGalleryTest = ()=>{
    const imgGallerySrcs = (()=>{
        const srcs = [];
        for(let i = 0; i < 6; i++)// srcs.push('https://placekitten.com/640/360')
        // srcs.push('https://placekitten.com/360/640')
        srcs.push("https://placekitten.com/360/360");
        return srcs;
    })();
    return /*#__PURE__*/ _jsx("div", {
        className: "space-y-2",
        children: imgGallerySrcs.map((_, index)=>/*#__PURE__*/ _jsx("div", {
                className: "p-4 pb-2 rounded-lg bg-[#D1E9FF80]",
                children: /*#__PURE__*/ _jsx(ImageGallery, {
                    srcs: imgGallerySrcs.slice(0, index + 1)
                })
            }, index))
    });
};

;// CONCATENATED MODULE: ./app/components/chat/thought/panel.tsx
/* __next_internal_client_entry_do_not_use__  auto */ 


const Panel = ({ isRequest , toolName , content  })=>{
    const { t  } = (0,es/* useTranslation */.$G)();
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: "rounded-md bg-gray-100 overflow-hidden border border-black/5",
        children: [
            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                className: "flex items-center px-2 py-1 leading-[18px] bg-gray-50 uppercase text-xs font-medium text-gray-500",
                children: [
                    t(`tools.thought.${isRequest ? "requestTitle" : "responseTitle"}`),
                    " ",
                    toolName
                ]
            }),
            /*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: "p-2 border-t border-black/5 leading-4 text-xs text-gray-700",
                children: content
            })
        ]
    });
};
/* harmony default export */ const panel = (/*#__PURE__*/react_default().memo(Panel));

;// CONCATENATED MODULE: ./app/components/base/icons/line/loading-02/data.json
const loading_02_data_namespaceObject = JSON.parse('{"icon":{"type":"element","isRootNode":true,"name":"svg","attributes":{"width":"16","height":"16","viewBox":"0 0 16 16","fill":"none","xmlns":"http://www.w3.org/2000/svg"},"children":[{"type":"element","name":"g","attributes":{"clip-path":"url(#clip0_6037_51601)"},"children":[{"type":"element","name":"path","attributes":{"d":"M7.99992 1.33398V4.00065M7.99992 12.0007V14.6673M3.99992 8.00065H1.33325M14.6666 8.00065H11.9999M12.7189 12.7196L10.8333 10.834M12.7189 3.33395L10.8333 5.21956M3.28097 12.7196L5.16659 10.834M3.28097 3.33395L5.16659 5.21956","stroke":"currentColor","stroke-width":"1.25","stroke-linecap":"round","stroke-linejoin":"round"},"children":[]}]},{"type":"element","name":"defs","attributes":{},"children":[{"type":"element","name":"clipPath","attributes":{"id":"clip0_6037_51601"},"children":[{"type":"element","name":"rect","attributes":{"width":"16","height":"16","fill":"white"},"children":[]}]}]}]},"name":"Loading02"}');
;// CONCATENATED MODULE: ./app/components/base/icons/line/loading-02/index.tsx




const loading_02_Icon = /*#__PURE__*/ react_.forwardRef((props, ref)=>/*#__PURE__*/ jsx_runtime_.jsx(icons_IconBase, {
        ...props,
        ref: ref,
        data: loading_02_data_namespaceObject
    }));
loading_02_Icon.displayName = "Loading02";
/* harmony default export */ const loading_02 = (loading_02_Icon);

;// CONCATENATED MODULE: ./app/components/base/icons/line/arrows/chevron-down/data.json
const chevron_down_data_namespaceObject = JSON.parse('{"icon":{"type":"element","isRootNode":true,"name":"svg","attributes":{"width":"12","height":"12","viewBox":"0 0 12 12","fill":"none","xmlns":"http://www.w3.org/2000/svg"},"children":[{"type":"element","name":"g","attributes":{"id":"chevron-down"},"children":[{"type":"element","name":"path","attributes":{"id":"Icon","d":"M3 4.5L6 7.5L9 4.5","stroke":"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},"children":[]}]}]},"name":"ChevronDown"}');
;// CONCATENATED MODULE: ./app/components/base/icons/line/arrows/chevron-down/index.tsx
// GENERATE BY script
// DON NOT EDIT IT MANUALLY




const chevron_down_Icon = /*#__PURE__*/ react_.forwardRef((props, ref)=>/*#__PURE__*/ jsx_runtime_.jsx(icons_IconBase, {
        ...props,
        ref: ref,
        data: chevron_down_data_namespaceObject
    }));
chevron_down_Icon.displayName = "ChevronDown";
/* harmony default export */ const chevron_down = (chevron_down_Icon);

;// CONCATENATED MODULE: ./app/components/base/icons/solid/general/check-circle/data.json
const check_circle_data_namespaceObject = JSON.parse('{"icon":{"type":"element","isRootNode":true,"name":"svg","attributes":{"width":"16","height":"16","viewBox":"0 0 16 16","fill":"none","xmlns":"http://www.w3.org/2000/svg"},"children":[{"type":"element","name":"g","attributes":{"id":"check-circle"},"children":[{"type":"element","name":"path","attributes":{"id":"Solid","fill-rule":"evenodd","clip-rule":"evenodd","d":"M8 0.666626C3.94992 0.666626 0.666672 3.94987 0.666672 7.99996C0.666672 12.05 3.94992 15.3333 8 15.3333C12.0501 15.3333 15.3333 12.05 15.3333 7.99996C15.3333 3.94987 12.0501 0.666626 8 0.666626ZM11.4714 6.47136C11.7318 6.21101 11.7318 5.7889 11.4714 5.52855C11.2111 5.26821 10.7889 5.26821 10.5286 5.52855L7 9.05715L5.47141 7.52855C5.21106 7.2682 4.78895 7.2682 4.5286 7.52855C4.26825 7.7889 4.26825 8.21101 4.5286 8.47136L6.5286 10.4714C6.78895 10.7317 7.21106 10.7317 7.47141 10.4714L11.4714 6.47136Z","fill":"currentColor"},"children":[]}]}]},"name":"CheckCircle"}');
;// CONCATENATED MODULE: ./app/components/base/icons/solid/general/check-circle/index.tsx
// GENERATE BY script
// DON NOT EDIT IT MANUALLY




const check_circle_Icon = /*#__PURE__*/ react_.forwardRef((props, ref)=>/*#__PURE__*/ jsx_runtime_.jsx(icons_IconBase, {
        ...props,
        ref: ref,
        data: check_circle_data_namespaceObject
    }));
check_circle_Icon.displayName = "CheckCircle";
/* harmony default export */ const check_circle = (check_circle_Icon);

;// CONCATENATED MODULE: ./app/components/base/icons/public/data-set/data.json
const data_set_data_namespaceObject = JSON.parse('{"icon":{"type":"element","isRootNode":true,"name":"svg","attributes":{"width":"12","height":"12","viewBox":"0 0 12 12","fill":"none","xmlns":"http://www.w3.org/2000/svg"},"children":[{"type":"element","name":"g","attributes":{"clip-path":"url(#clip0_7847_32895)"},"children":[{"type":"element","name":"path","attributes":{"d":"M10.5 2.5C10.5 3.32843 8.48528 4 6 4C3.51472 4 1.5 3.32843 1.5 2.5M10.5 2.5C10.5 1.67157 8.48528 1 6 1C3.51472 1 1.5 1.67157 1.5 2.5M10.5 2.5V9.5C10.5 10.33 8.5 11 6 11C3.5 11 1.5 10.33 1.5 9.5V2.5M10.5 6C10.5 6.83 8.5 7.5 6 7.5C3.5 7.5 1.5 6.83 1.5 6","stroke":"#667085","stroke-width":"1.25","stroke-linecap":"round","stroke-linejoin":"round"},"children":[]}]},{"type":"element","name":"defs","attributes":{},"children":[{"type":"element","name":"clipPath","attributes":{"id":"clip0_7847_32895"},"children":[{"type":"element","name":"rect","attributes":{"width":"12","height":"12","fill":"white"},"children":[]}]}]}]},"name":"DataSet"}');
;// CONCATENATED MODULE: ./app/components/base/icons/public/data-set/index.tsx
// GENERATE BY script
// DON NOT EDIT IT MANUALLY




const data_set_Icon = /*#__PURE__*/ react_.forwardRef((props, ref)=>/*#__PURE__*/ jsx_runtime_.jsx(icons_IconBase, {
        ...props,
        ref: ref,
        data: data_set_data_namespaceObject
    }));
data_set_Icon.displayName = "DataSet";
/* harmony default export */ const data_set = (data_set_Icon);

;// CONCATENATED MODULE: ./app/components/chat/thought/tool.tsx
/* __next_internal_client_entry_do_not_use__  auto */ 









const getIcon = (toolName, allToolIcons)=>{
    if (toolName.startsWith("dataset-")) return /*#__PURE__*/ jsx_runtime_.jsx(data_set, {
        className: "shrink-0"
    });
    const icon = allToolIcons[toolName];
    if (!icon) return null;
    return typeof icon === "string" ? /*#__PURE__*/ jsx_runtime_.jsx("div", {
        className: "w-3 h-3 bg-cover bg-center rounded-[3px] shrink-0",
        style: {
            backgroundImage: `url(${icon})`
        }
    }) : /*#__PURE__*/ jsx_runtime_.jsx(app_icon, {
        className: "rounded-[3px] shrink-0",
        size: "xs",
        icon: icon?.content,
        background: icon?.background
    });
};
const Tool = ({ payload , allToolIcons ={}  })=>{
    const { t  } = (0,es/* useTranslation */.$G)();
    const { name , input , isFinished , output  } = payload;
    const toolName = name.startsWith("dataset-") ? t("dataset.knowledge") : name;
    const [isShowDetail, setIsShowDetail] = (0,react_.useState)(false);
    const icon = getIcon(toolName, allToolIcons);
    return /*#__PURE__*/ jsx_runtime_.jsx("div", {
        children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
            className: classnames_default()(!isShowDetail && "shadow-sm", !isShowDetail && "inline-block", "max-w-full overflow-x-auto bg-white rounded-md"),
            children: [
                /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                    className: classnames_default()("flex items-center h-7 px-2 cursor-pointer"),
                    onClick: ()=>setIsShowDetail(!isShowDetail),
                    children: [
                        !isFinished && /*#__PURE__*/ jsx_runtime_.jsx(loading_02, {
                            className: "w-3 h-3 text-gray-500 animate-spin shrink-0"
                        }),
                        isFinished && !isShowDetail && /*#__PURE__*/ jsx_runtime_.jsx(check_circle, {
                            className: "w-3 h-3 text-[#12B76A] shrink-0"
                        }),
                        isFinished && isShowDetail && icon,
                        /*#__PURE__*/ jsx_runtime_.jsx("span", {
                            className: "mx-1 text-xs font-medium text-gray-500 shrink-0",
                            children: t(`tools.thought.${isFinished ? "used" : "using"}`)
                        }),
                        /*#__PURE__*/ jsx_runtime_.jsx("span", {
                            className: "text-xs font-medium text-gray-700 truncate",
                            title: toolName,
                            children: toolName
                        }),
                        /*#__PURE__*/ jsx_runtime_.jsx(chevron_down, {
                            className: classnames_default()(isShowDetail && "rotate-180", "ml-1 w-3 h-3 text-gray-500 select-none cursor-pointer shrink-0")
                        })
                    ]
                }),
                isShowDetail && /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                    className: "border-t border-black/5 p-2 space-y-2 ",
                    children: [
                        /*#__PURE__*/ jsx_runtime_.jsx(panel, {
                            isRequest: true,
                            toolName: toolName,
                            content: input
                        }),
                        output && /*#__PURE__*/ jsx_runtime_.jsx(panel, {
                            isRequest: false,
                            toolName: toolName,
                            content: output
                        })
                    ]
                })
            ]
        })
    });
};
/* harmony default export */ const tool = (/*#__PURE__*/react_default().memo(Tool));

;// CONCATENATED MODULE: ./app/components/chat/thought/index.tsx
/* __next_internal_client_entry_do_not_use__  auto */ 


function getValue(value, isValueArray, index) {
    if (isValueArray) {
        try {
            return JSON.parse(value)[index];
        } catch (e) {}
    }
    return value;
}
const Thought = ({ thought , allToolIcons , isFinished  })=>{
    const [toolNames, isValueArray] = (()=>{
        try {
            if (Array.isArray(JSON.parse(thought.tool))) return [
                JSON.parse(thought.tool),
                true
            ];
        } catch (e) {}
        return [
            [
                thought.tool
            ],
            false
        ];
    })();
    const toolThoughtList = toolNames.map((toolName, index)=>{
        return {
            name: toolName,
            input: getValue(thought.tool_input, isValueArray, index),
            output: getValue(thought.observation, isValueArray, index),
            isFinished
        };
    });
    return /*#__PURE__*/ jsx_runtime_.jsx("div", {
        className: "my-2 space-y-2",
        children: toolThoughtList.map((item, index)=>/*#__PURE__*/ jsx_runtime_.jsx(tool, {
                payload: item,
                allToolIcons: allToolIcons
            }, index))
    });
};
/* harmony default export */ const thought = (/*#__PURE__*/react_default().memo(Thought));

;// CONCATENATED MODULE: ./utils/string.ts
const chars = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_";
function randomString(length) {
    let result = "";
    for(let i = length; i > 0; --i)result += chars[Math.floor(Math.random() * chars.length)];
    return result;
}

// EXTERNAL MODULE: ./node_modules/react-tooltip/dist/react-tooltip.cjs.min.js
var react_tooltip_cjs_min = __webpack_require__(94827);
// EXTERNAL MODULE: ./node_modules/react-tooltip/dist/react-tooltip.css
var react_tooltip = __webpack_require__(54893);
;// CONCATENATED MODULE: ./app/components/base/tooltip/index.tsx
/* __next_internal_client_entry_do_not_use__  auto */ 


 // fixed version to 5.8.3 https://github.com/ReactTooltip/react-tooltip/issues/972

const Tooltip = ({ selector , content , position ="top" , children , htmlContent , className , clickable  })=>{
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: "tooltip-container",
        children: [
            /*#__PURE__*/ react_default().cloneElement(children, {
                "data-tooltip-id": selector
            }),
            /*#__PURE__*/ jsx_runtime_.jsx(react_tooltip_cjs_min/* Tooltip */.u, {
                id: selector,
                content: content,
                className: classnames_default()("!bg-white !text-xs !font-normal !text-gray-700 !shadow-lg !opacity-100", className),
                place: position,
                clickable: clickable,
                children: htmlContent && htmlContent
            })
        ]
    });
};
/* harmony default export */ const tooltip = (Tooltip);

// EXTERNAL MODULE: ./node_modules/react-markdown/lib/react-markdown.js + 84 modules
var react_markdown = __webpack_require__(75064);
// EXTERNAL MODULE: ./node_modules/katex/dist/katex.min.css
var katex_min = __webpack_require__(14095);
// EXTERNAL MODULE: ./node_modules/remark-math/index.js + 5 modules
var remark_math = __webpack_require__(81645);
// EXTERNAL MODULE: ./node_modules/remark-breaks/index.js + 1 modules
var remark_breaks = __webpack_require__(28969);
// EXTERNAL MODULE: ./node_modules/rehype-katex/index.js + 35 modules
var rehype_katex = __webpack_require__(70644);
// EXTERNAL MODULE: ./node_modules/remark-gfm/index.js + 24 modules
var remark_gfm = __webpack_require__(78720);
// EXTERNAL MODULE: ./node_modules/react-syntax-highlighter/dist/cjs/index.js
var cjs = __webpack_require__(41250);
// EXTERNAL MODULE: ./node_modules/react-syntax-highlighter/dist/esm/styles/hljs/atelier-heath-light.js
var atelier_heath_light = __webpack_require__(68953);
;// CONCATENATED MODULE: ./app/components/base/markdown.tsx









function Markdown(props) {
    return /*#__PURE__*/ jsx_runtime_.jsx("div", {
        className: "markdown-body",
        children: /*#__PURE__*/ jsx_runtime_.jsx(react_markdown/* ReactMarkdown */.D, {
            remarkPlugins: [
                remark_math/* default */.Z,
                remark_gfm/* default */.Z,
                remark_breaks/* default */.Z
            ],
            rehypePlugins: [
                rehype_katex/* default */.Z
            ],
            components: {
                code ({ node , inline , className , children , ...props }) {
                    const match = /language-(\w+)/.exec(className || "");
                    return !inline && match ? /*#__PURE__*/ jsx_runtime_.jsx(cjs/* default */.ZP, {
                        ...props,
                        children: String(children).replace(/\n$/, ""),
                        style: atelier_heath_light/* default */.Z,
                        language: match[1],
                        showLineNumbers: true,
                        PreTag: "div"
                    }) : /*#__PURE__*/ jsx_runtime_.jsx("code", {
                        ...props,
                        className: className,
                        children: children
                    });
                }
            },
            linkTarget: "_blank",
            children: props.content
        })
    });
}

;// CONCATENATED MODULE: ./app/components/chat/answer/index.tsx
/* __next_internal_client_entry_do_not_use__ EditIconSolid auto */ 










const OperationBtn = ({ innerContent , onClick , className  })=>/*#__PURE__*/ jsx_runtime_.jsx("div", {
        className: `relative box-border flex items-center justify-center h-7 w-7 p-0.5 rounded-lg bg-white cursor-pointer text-gray-500 hover:text-gray-800 ${className ?? ""}`,
        style: {
            boxShadow: "0px 4px 6px -1px rgba(0, 0, 0, 0.1), 0px 2px 4px -2px rgba(0, 0, 0, 0.05)"
        },
        onClick: onClick && onClick,
        children: innerContent
    });
const OpeningStatementIcon = ({ className  })=>/*#__PURE__*/ _jsx("svg", {
        width: "12",
        height: "12",
        viewBox: "0 0 12 12",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        children: /*#__PURE__*/ _jsx("path", {
            fillRule: "evenodd",
            clipRule: "evenodd",
            d: "M6.25002 1C3.62667 1 1.50002 3.12665 1.50002 5.75C1.50002 6.28 1.58702 6.79071 1.7479 7.26801C1.7762 7.35196 1.79285 7.40164 1.80368 7.43828L1.80722 7.45061L1.80535 7.45452C1.79249 7.48102 1.77339 7.51661 1.73766 7.58274L0.911727 9.11152C0.860537 9.20622 0.807123 9.30503 0.770392 9.39095C0.733879 9.47635 0.674738 9.63304 0.703838 9.81878C0.737949 10.0365 0.866092 10.2282 1.05423 10.343C1.21474 10.4409 1.38213 10.4461 1.475 10.4451C1.56844 10.444 1.68015 10.4324 1.78723 10.4213L4.36472 10.1549C4.406 10.1506 4.42758 10.1484 4.44339 10.1472L4.44542 10.147L4.45161 10.1492C4.47103 10.1562 4.49738 10.1663 4.54285 10.1838C5.07332 10.3882 5.64921 10.5 6.25002 10.5C8.87338 10.5 11 8.37335 11 5.75C11 3.12665 8.87338 1 6.25002 1ZM4.48481 4.29111C5.04844 3.81548 5.7986 3.9552 6.24846 4.47463C6.69831 3.9552 7.43879 3.82048 8.01211 4.29111C8.58544 4.76175 8.6551 5.562 8.21247 6.12453C7.93825 6.47305 7.24997 7.10957 6.76594 7.54348C6.58814 7.70286 6.49924 7.78255 6.39255 7.81466C6.30103 7.84221 6.19589 7.84221 6.10436 7.81466C5.99767 7.78255 5.90878 7.70286 5.73098 7.54348C5.24694 7.10957 4.55867 6.47305 4.28444 6.12453C3.84182 5.562 3.92117 4.76675 4.48481 4.29111Z",
            fill: "#667085"
        })
    });
const RatingIcon = ({ isLike  })=>{
    return isLike ? /*#__PURE__*/ jsx_runtime_.jsx(HandThumbUpIcon/* default */.Z, {
        className: "w-4 h-4"
    }) : /*#__PURE__*/ jsx_runtime_.jsx(HandThumbDownIcon/* default */.Z, {
        className: "w-4 h-4"
    });
};
const EditIcon = ({ className  })=>{
    return /*#__PURE__*/ _jsx("svg", {
        width: "16",
        height: "16",
        viewBox: "0 0 16 16",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        className: className,
        children: /*#__PURE__*/ _jsx("path", {
            d: "M14 11.9998L13.3332 12.7292C12.9796 13.1159 12.5001 13.3332 12.0001 13.3332C11.5001 13.3332 11.0205 13.1159 10.6669 12.7292C10.3128 12.3432 9.83332 12.1265 9.33345 12.1265C8.83359 12.1265 8.35409 12.3432 7.99998 12.7292M2 13.3332H3.11636C3.44248 13.3332 3.60554 13.3332 3.75899 13.2963C3.89504 13.2637 4.0251 13.2098 4.1444 13.1367C4.27895 13.0542 4.39425 12.9389 4.62486 12.7083L13 4.33316C13.5523 3.78087 13.5523 2.88544 13 2.33316C12.4477 1.78087 11.5523 1.78087 11 2.33316L2.62484 10.7083C2.39424 10.9389 2.27894 11.0542 2.19648 11.1888C2.12338 11.3081 2.0695 11.4381 2.03684 11.5742C2 11.7276 2 11.8907 2 12.2168V13.3332Z",
            stroke: "#6B7280",
            strokeLinecap: "round",
            strokeLinejoin: "round"
        })
    });
};
const EditIconSolid = ({ className  })=>{
    return /*#__PURE__*/ _jsxs("svg", {
        width: "12",
        height: "12",
        viewBox: "0 0 12 12",
        fill: "none",
        xmlns: "http://www.w3.org/2000/svg",
        className: className,
        children: [
            /*#__PURE__*/ _jsx("path", {
                fillRule: "evenodd",
                "clip-rule": "evenodd",
                d: "M10.8374 8.63108C11.0412 8.81739 11.0554 9.13366 10.8691 9.33747L10.369 9.88449C10.0142 10.2725 9.52293 10.5001 9.00011 10.5001C8.47746 10.5001 7.98634 10.2727 7.63157 9.8849C7.45561 9.69325 7.22747 9.59515 7.00014 9.59515C6.77271 9.59515 6.54446 9.69335 6.36846 9.88517C6.18177 10.0886 5.86548 10.1023 5.66201 9.91556C5.45853 9.72888 5.44493 9.41259 5.63161 9.20911C5.98678 8.82201 6.47777 8.59515 7.00014 8.59515C7.52251 8.59515 8.0135 8.82201 8.36867 9.20911L8.36924 9.20974C8.54486 9.4018 8.77291 9.50012 9.00011 9.50012C9.2273 9.50012 9.45533 9.40182 9.63095 9.20979L10.131 8.66276C10.3173 8.45895 10.6336 8.44476 10.8374 8.63108Z",
                fill: "#6B7280"
            }),
            /*#__PURE__*/ _jsx("path", {
                fillRule: "evenodd",
                "clip-rule": "evenodd",
                d: "M7.89651 1.39656C8.50599 0.787085 9.49414 0.787084 10.1036 1.39656C10.7131 2.00604 10.7131 2.99419 10.1036 3.60367L3.82225 9.88504C3.81235 9.89494 3.80254 9.90476 3.79281 9.91451C3.64909 10.0585 3.52237 10.1855 3.3696 10.2791C3.23539 10.3613 3.08907 10.4219 2.93602 10.4587C2.7618 10.5005 2.58242 10.5003 2.37897 10.5001C2.3652 10.5001 2.35132 10.5001 2.33732 10.5001H1.50005C1.22391 10.5001 1.00005 10.2763 1.00005 10.0001V9.16286C1.00005 9.14886 1.00004 9.13497 1.00003 9.1212C0.999836 8.91776 0.999669 8.73838 1.0415 8.56416C1.07824 8.4111 1.13885 8.26479 1.22109 8.13058C1.31471 7.97781 1.44166 7.85109 1.58566 7.70736C1.5954 7.69764 1.60523 7.68783 1.61513 7.67793L7.89651 1.39656Z",
                fill: "#6B7280"
            })
        ]
    });
};
const IconWrapper = ({ children  })=>{
    return /*#__PURE__*/ jsx_runtime_.jsx("div", {
        className: "rounded-lg h-6 w-6 flex items-center justify-center hover:bg-gray-100",
        children: children
    });
};
// The component needs to maintain its own state to control whether to display input component
const Answer = ({ item , feedbackDisabled =false , onFeedback , isResponsing , allToolIcons  })=>{
    const { id , content , feedback , agent_thoughts  } = item;
    const isAgentMode = !!agent_thoughts && agent_thoughts.length > 0;
    const { t  } = (0,es/* useTranslation */.$G)();
    /**
 * Render feedback results (distinguish between users and administrators)
 * User reviews cannot be cancelled in Console
 * @param rating feedback result
 * @param isUserFeedback Whether it is user's feedback
 * @returns comp
 */ const renderFeedbackRating = (rating)=>{
        if (!rating) return null;
        const isLike = rating === "like";
        const ratingIconClassname = isLike ? "text-primary-600 bg-primary-100 hover:bg-primary-200" : "text-red-600 bg-red-100 hover:bg-red-200";
        // The tooltip is always displayed, but the content is different for different scenarios.
        return /*#__PURE__*/ jsx_runtime_.jsx(tooltip, {
            selector: `user-feedback-${randomString(16)}`,
            content: isLike ? "取消赞同" : "取消反对",
            children: /*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: "relative box-border flex items-center justify-center h-7 w-7 p-0.5 rounded-lg bg-white cursor-pointer text-gray-500 hover:text-gray-800",
                style: {
                    boxShadow: "0px 4px 6px -1px rgba(0, 0, 0, 0.1), 0px 2px 4px -2px rgba(0, 0, 0, 0.05)"
                },
                onClick: async ()=>{
                    await onFeedback?.(id, {
                        rating: null
                    });
                },
                children: /*#__PURE__*/ jsx_runtime_.jsx("div", {
                    className: `${ratingIconClassname} rounded-lg h-6 w-6 flex items-center justify-center`,
                    children: /*#__PURE__*/ jsx_runtime_.jsx(RatingIcon, {
                        isLike: isLike
                    })
                })
            })
        });
    };
    /**
   * Different scenarios have different operation items.
   * @returns comp
   */ const renderItemOperation = ()=>{
        const userOperation = ()=>{
            return feedback?.rating ? null : /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                className: "flex gap-1",
                children: [
                    /*#__PURE__*/ jsx_runtime_.jsx(tooltip, {
                        selector: `user-feedback-${randomString(16)}`,
                        content: t("common.operation.like"),
                        children: OperationBtn({
                            innerContent: /*#__PURE__*/ jsx_runtime_.jsx(IconWrapper, {
                                children: /*#__PURE__*/ jsx_runtime_.jsx(RatingIcon, {
                                    isLike: true
                                })
                            }),
                            onClick: ()=>onFeedback?.(id, {
                                    rating: "like"
                                })
                        })
                    }),
                    /*#__PURE__*/ jsx_runtime_.jsx(tooltip, {
                        selector: `user-feedback-${randomString(16)}`,
                        content: t("common.operation.dislike"),
                        children: OperationBtn({
                            innerContent: /*#__PURE__*/ jsx_runtime_.jsx(IconWrapper, {
                                children: /*#__PURE__*/ jsx_runtime_.jsx(RatingIcon, {
                                    isLike: false
                                })
                            }),
                            onClick: ()=>onFeedback?.(id, {
                                    rating: "dislike"
                                })
                        })
                    })
                ]
            });
        };
        return /*#__PURE__*/ jsx_runtime_.jsx("div", {
            className: `${(chat_style_module_default()).itemOperation} flex gap-2`,
            children: userOperation()
        });
    };
    const getImgs = (list)=>{
        if (!list) return [];
        return list.filter((file)=>file.type === "image" && file.belongs_to === "assistant");
    };
    const agentModeAnswer = /*#__PURE__*/ jsx_runtime_.jsx("div", {
        children: agent_thoughts?.map((item, index)=>/*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                children: [
                    item.thought && /*#__PURE__*/ jsx_runtime_.jsx(Markdown, {
                        content: item.thought
                    }),
                    !!item.tool && /*#__PURE__*/ jsx_runtime_.jsx(thought, {
                        thought: item,
                        allToolIcons: allToolIcons || {},
                        isFinished: !!item.observation || !isResponsing
                    }),
                    getImgs(item.message_files).length > 0 && /*#__PURE__*/ jsx_runtime_.jsx(image_gallery, {
                        srcs: getImgs(item.message_files).map((item)=>item.url)
                    })
                ]
            }, index))
    });
    return /*#__PURE__*/ jsx_runtime_.jsx("div", {
        children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
            className: "flex items-start",
            children: [
                /*#__PURE__*/ jsx_runtime_.jsx("div", {
                    className: `${(chat_style_module_default()).answerIcon} w-10 h-10 shrink-0`,
                    children: isResponsing && /*#__PURE__*/ jsx_runtime_.jsx("div", {
                        className: (chat_style_module_default()).typeingIcon,
                        children: /*#__PURE__*/ jsx_runtime_.jsx(loading_anim, {
                            type: "avatar"
                        })
                    })
                }),
                /*#__PURE__*/ jsx_runtime_.jsx("div", {
                    className: `${(chat_style_module_default()).answerWrap}`,
                    children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                        className: `${(chat_style_module_default()).answer} relative text-sm text-gray-900`,
                        children: [
                            /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                className: "ml-2 py-3 px-4 bg-gray-100 rounded-tr-2xl rounded-b-2xl",
                                children: isResponsing && (isAgentMode ? !content && (agent_thoughts || []).filter((item)=>!!item.thought || !!item.tool).length === 0 : !content) ? /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                    className: "flex items-center justify-center w-6 h-5",
                                    children: /*#__PURE__*/ jsx_runtime_.jsx(loading_anim, {
                                        type: "text"
                                    })
                                }) : isAgentMode ? agentModeAnswer : /*#__PURE__*/ jsx_runtime_.jsx(Markdown, {
                                    content: content
                                })
                            }),
                            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                className: "absolute top-[-14px] right-[-14px] flex flex-row justify-end gap-1",
                                children: [
                                    !feedbackDisabled && !item.feedbackDisabled && renderItemOperation(),
                                    !feedbackDisabled && renderFeedbackRating(feedback?.rating)
                                ]
                            })
                        ]
                    })
                })
            ]
        })
    }, id);
};
/* harmony default export */ const answer = (/*#__PURE__*/react_default().memo(Answer));

;// CONCATENATED MODULE: ./app/components/chat/question/index.tsx
/* __next_internal_client_entry_do_not_use__  auto */ 




const Question = ({ id , content , useCurrentUserAvatar , imgSrcs  })=>{
    const userName = "";
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: "flex items-start justify-end",
        children: [
            /*#__PURE__*/ jsx_runtime_.jsx("div", {
                children: /*#__PURE__*/ jsx_runtime_.jsx("div", {
                    className: `${(chat_style_module_default()).question} relative text-sm text-gray-900`,
                    children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                        className: "mr-2 py-3 px-4 bg-blue-500 rounded-tl-2xl rounded-b-2xl",
                        children: [
                            imgSrcs && imgSrcs.length > 0 && /*#__PURE__*/ jsx_runtime_.jsx(image_gallery, {
                                srcs: imgSrcs
                            }),
                            /*#__PURE__*/ jsx_runtime_.jsx(Markdown, {
                                content: content
                            })
                        ]
                    })
                })
            }),
            useCurrentUserAvatar ? /*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: "w-10 h-10 shrink-0 leading-10 text-center mr-2 rounded-full bg-primary-600 text-white",
                children: userName?.[0].toLocaleUpperCase()
            }) : /*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: `${(chat_style_module_default()).questionIcon} w-10 h-10 shrink-0 `
            })
        ]
    }, id);
};
/* harmony default export */ const question = (/*#__PURE__*/react_default().memo(Question));

;// CONCATENATED MODULE: ./app/components/base/image-uploader/utils.ts
/* __next_internal_client_entry_do_not_use__ imageUpload auto */ 
const imageUpload = ({ file , onProgressCallback , onSuccessCallback , onErrorCallback  })=>{
    const formData = new FormData();
    formData.append("file", file);
    const onProgress = (e)=>{
        if (e.lengthComputable) {
            const percent = Math.floor(e.loaded / e.total * 100);
            onProgressCallback(percent);
        }
    };
    upload({
        xhr: new XMLHttpRequest(),
        data: formData,
        onprogress: onProgress
    }).then((res)=>{
        onSuccessCallback(res);
    }).catch(()=>{
        onErrorCallback();
    });
};

;// CONCATENATED MODULE: ./app/components/base/image-uploader/uploader.tsx
/* __next_internal_client_entry_do_not_use__  auto */ 





const Uploader = ({ children , onUpload , limit , disabled  })=>{
    const [hovering, setHovering] = (0,react_.useState)(false);
    const { notify  } = toast;
    const { t  } = (0,es/* useTranslation */.$G)();
    const handleChange = (e)=>{
        const file = e.target.files?.[0];
        if (!file) return;
        if (limit && file.size > limit * 1024 * 1024) {
            notify({
                type: "error",
                message: t("common.imageUploader.uploadFromComputerLimit", {
                    size: limit
                })
            });
            return;
        }
        const reader = new FileReader();
        reader.addEventListener("load", ()=>{
            const imageFile = {
                type: TransferMethod.local_file,
                _id: `${Date.now()}`,
                fileId: "",
                file,
                url: reader.result,
                base64Url: reader.result,
                progress: 0
            };
            onUpload(imageFile);
            imageUpload({
                file: imageFile.file,
                onProgressCallback: (progress)=>{
                    onUpload({
                        ...imageFile,
                        progress
                    });
                },
                onSuccessCallback: (res)=>{
                    onUpload({
                        ...imageFile,
                        fileId: res.id,
                        progress: 100
                    });
                },
                onErrorCallback: ()=>{
                    notify({
                        type: "error",
                        message: t("common.imageUploader.uploadFromComputerUploadError")
                    });
                    onUpload({
                        ...imageFile,
                        progress: -1
                    });
                }
            });
        }, false);
        reader.addEventListener("error", ()=>{
            notify({
                type: "error",
                message: t("common.imageUploader.uploadFromComputerReadError")
            });
        }, false);
        reader.readAsDataURL(file);
    };
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: "relative",
        onMouseEnter: ()=>setHovering(true),
        onMouseLeave: ()=>setHovering(false),
        children: [
            children(hovering),
            /*#__PURE__*/ jsx_runtime_.jsx("input", {
                className: `
          absolute block inset-0 opacity-0 text-[0] w-full
          ${disabled ? "cursor-not-allowed" : "cursor-pointer"}
        `,
                onClick: (e)=>e.target.value = "",
                type: "file",
                accept: ".png, .jpg, .jpeg, .webp, .gif",
                onChange: handleChange,
                disabled: disabled
            })
        ]
    });
};
/* harmony default export */ const uploader = (Uploader);

;// CONCATENATED MODULE: ./app/components/base/image-uploader/image-link-input.tsx





const image_link_input_regex = /^(https?|ftp):\/\//;
const ImageLinkInput = ({ onUpload  })=>{
    const { t  } = (0,es/* useTranslation */.$G)();
    const [imageLink, setImageLink] = (0,react_.useState)("");
    const handleClick = ()=>{
        const imageFile = {
            type: TransferMethod.remote_url,
            _id: `${Date.now()}`,
            fileId: "",
            progress: image_link_input_regex.test(imageLink) ? 0 : -1,
            url: imageLink
        };
        onUpload(imageFile);
    };
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: "flex items-center pl-1.5 pr-1 h-8 border border-gray-200 bg-white shadow-xs rounded-lg",
        children: [
            /*#__PURE__*/ jsx_runtime_.jsx("input", {
                className: "grow mr-0.5 px-1 h-[18px] text-[13px] outline-none appearance-none",
                value: imageLink,
                onChange: (e)=>setImageLink(e.target.value),
                placeholder: t("common.imageUploader.pasteImageLinkInputPlaceholder") || ""
            }),
            /*#__PURE__*/ jsx_runtime_.jsx(base_button, {
                type: "primary",
                className: "!h-6 text-xs font-medium",
                disabled: !imageLink,
                onClick: handleClick,
                children: t("common.operation.ok")
            })
        ]
    });
};
/* harmony default export */ const image_link_input = (ImageLinkInput);

;// CONCATENATED MODULE: ./app/components/base/icons/line/image-plus/data.json
const image_plus_data_namespaceObject = JSON.parse('{"icon":{"type":"element","isRootNode":true,"name":"svg","attributes":{"width":"16","height":"16","viewBox":"0 0 16 16","fill":"none","xmlns":"http://www.w3.org/2000/svg"},"children":[{"type":"element","name":"g","attributes":{"id":"image-plus"},"children":[{"type":"element","name":"path","attributes":{"id":"Icon","d":"M8.33333 2.00016H5.2C4.0799 2.00016 3.51984 2.00016 3.09202 2.21815C2.71569 2.4099 2.40973 2.71586 2.21799 3.09218C2 3.52001 2 4.08006 2 5.20016V10.8002C2 11.9203 2 12.4803 2.21799 12.9081C2.40973 13.2845 2.71569 13.5904 3.09202 13.7822C3.51984 14.0002 4.07989 14.0002 5.2 14.0002H11.3333C11.9533 14.0002 12.2633 14.0002 12.5176 13.932C13.2078 13.7471 13.7469 13.208 13.9319 12.5178C14 12.2635 14 11.9535 14 11.3335M12.6667 5.3335V1.3335M10.6667 3.3335H14.6667M7 5.66683C7 6.40321 6.40305 7.00016 5.66667 7.00016C4.93029 7.00016 4.33333 6.40321 4.33333 5.66683C4.33333 4.93045 4.93029 4.3335 5.66667 4.3335C6.40305 4.3335 7 4.93045 7 5.66683ZM9.99336 7.94559L4.3541 13.0722C4.03691 13.3605 3.87831 13.5047 3.86429 13.6296C3.85213 13.7379 3.89364 13.8453 3.97546 13.9172C4.06985 14.0002 4.28419 14.0002 4.71286 14.0002H10.9707C11.9301 14.0002 12.4098 14.0002 12.7866 13.839C13.2596 13.6366 13.6365 13.2598 13.8388 12.7868C14 12.41 14 11.9303 14 10.9708C14 10.648 14 10.4866 13.9647 10.3363C13.9204 10.1474 13.8353 9.9704 13.7155 9.81776C13.6202 9.6963 13.4941 9.59546 13.242 9.3938L11.3772 7.90194C11.1249 7.7001 10.9988 7.59919 10.8599 7.56357C10.7374 7.53218 10.6086 7.53624 10.4884 7.57529C10.352 7.61959 10.2324 7.72826 9.99336 7.94559Z","stroke":"currentColor","stroke-width":"1.25","stroke-linecap":"round","stroke-linejoin":"round"},"children":[]}]}]},"name":"ImagePlus"}');
;// CONCATENATED MODULE: ./app/components/base/icons/line/image-plus/index.tsx




const image_plus_Icon = /*#__PURE__*/ react_.forwardRef((props, ref)=>/*#__PURE__*/ jsx_runtime_.jsx(icons_IconBase, {
        ...props,
        ref: ref,
        data: image_plus_data_namespaceObject
    }));
image_plus_Icon.displayName = "ImagePlus";
/* harmony default export */ const image_plus = (image_plus_Icon);

// EXTERNAL MODULE: ./node_modules/@floating-ui/react/dist/floating-ui.react.mjs + 2 modules
var floating_ui_react = __webpack_require__(55022);
// EXTERNAL MODULE: ./node_modules/@floating-ui/react-dom/node_modules/@floating-ui/dom/dist/floating-ui.dom.mjs
var floating_ui_dom = __webpack_require__(66396);
// EXTERNAL MODULE: ./node_modules/@floating-ui/core/dist/floating-ui.core.mjs
var floating_ui_core = __webpack_require__(47612);
;// CONCATENATED MODULE: ./app/components/base/portal-to-follow-elem/index.tsx
/* __next_internal_client_entry_do_not_use__ usePortalToFollowElem,usePortalToFollowElemContext,PortalToFollowElem,PortalToFollowElemTrigger,PortalToFollowElemContent auto */ 


function usePortalToFollowElem({ placement ="bottom" , open , offset: offsetValue = 0 , onOpenChange: setControlledOpen  } = {}) {
    const setOpen = setControlledOpen;
    const data = (0,floating_ui_react/* useFloating */.YF)({
        placement,
        open,
        onOpenChange: setOpen,
        whileElementsMounted: floating_ui_dom/* autoUpdate */.Me,
        middleware: [
            (0,floating_ui_core/* offset */.cv)(offsetValue),
            (0,floating_ui_dom/* flip */.RR)({
                crossAxis: placement.includes("-"),
                fallbackAxisSideDirection: "start",
                padding: 5
            }),
            (0,floating_ui_dom/* shift */.uY)({
                padding: 5
            })
        ]
    });
    const context = data.context;
    const hover = (0,floating_ui_react/* useHover */.XI)(context, {
        move: false,
        enabled: open == null
    });
    const focus = (0,floating_ui_react/* useFocus */.KK)(context, {
        enabled: open == null
    });
    const dismiss = (0,floating_ui_react/* useDismiss */.bQ)(context);
    const role = (0,floating_ui_react/* useRole */.qs)(context, {
        role: "tooltip"
    });
    const interactions = (0,floating_ui_react/* useInteractions */.NI)([
        hover,
        focus,
        dismiss,
        role
    ]);
    return react_default().useMemo(()=>({
            open,
            setOpen,
            ...interactions,
            ...data
        }), [
        open,
        setOpen,
        interactions,
        data
    ]);
}
const PortalToFollowElemContext = /*#__PURE__*/ react_default().createContext(null);
function usePortalToFollowElemContext() {
    const context = react_default().useContext(PortalToFollowElemContext);
    if (context == null) throw new Error("PortalToFollowElem components must be wrapped in <PortalToFollowElem />");
    return context;
}
function PortalToFollowElem({ children , ...options }) {
    // This can accept any props as options, e.g. `placement`,
    // or other positioning options.
    const tooltip = usePortalToFollowElem(options);
    return /*#__PURE__*/ jsx_runtime_.jsx(PortalToFollowElemContext.Provider, {
        value: tooltip,
        children: children
    });
}
const PortalToFollowElemTrigger = /*#__PURE__*/ react_default().forwardRef(({ children , asChild =false , ...props }, propRef)=>{
    const context = usePortalToFollowElemContext();
    const childrenRef = children.ref;
    const ref = (0,floating_ui_react/* useMergeRefs */.qq)([
        context.refs.setReference,
        propRef,
        childrenRef
    ]);
    // `asChild` allows the user to pass any element as the anchor
    if (asChild && /*#__PURE__*/ react_default().isValidElement(children)) {
        return /*#__PURE__*/ react_default().cloneElement(children, context.getReferenceProps({
            ref,
            ...props,
            ...children.props,
            "data-state": context.open ? "open" : "closed"
        }));
    }
    return /*#__PURE__*/ jsx_runtime_.jsx("div", {
        ref: ref,
        className: "inline-block",
        // The user can style the trigger based on the state
        "data-state": context.open ? "open" : "closed",
        ...context.getReferenceProps(props),
        children: children
    });
});
PortalToFollowElemTrigger.displayName = "PortalToFollowElemTrigger";
const PortalToFollowElemContent = /*#__PURE__*/ react_default().forwardRef(({ style , ...props }, propRef)=>{
    const context = usePortalToFollowElemContext();
    const ref = (0,floating_ui_react/* useMergeRefs */.qq)([
        context.refs.setFloating,
        propRef
    ]);
    if (!context.open) return null;
    return /*#__PURE__*/ jsx_runtime_.jsx(floating_ui_react/* FloatingPortal */.ll, {
        children: /*#__PURE__*/ jsx_runtime_.jsx("div", {
            ref: ref,
            style: {
                ...context.floatingStyles,
                ...style
            },
            ...context.getFloatingProps(props)
        })
    });
});
PortalToFollowElemContent.displayName = "PortalToFollowElemContent";

;// CONCATENATED MODULE: ./app/components/base/icons/line/upload-03/data.json
const upload_03_data_namespaceObject = JSON.parse('{"icon":{"type":"element","isRootNode":true,"name":"svg","attributes":{"width":"16","height":"16","viewBox":"0 0 16 16","fill":"none","xmlns":"http://www.w3.org/2000/svg"},"children":[{"type":"element","name":"g","attributes":{"id":"Left Icon","clip-path":"url(#clip0_12728_40636)"},"children":[{"type":"element","name":"path","attributes":{"id":"Icon","d":"M10.6654 8.00016L7.9987 5.3335M7.9987 5.3335L5.33203 8.00016M7.9987 5.3335V10.6668M14.6654 8.00016C14.6654 11.6821 11.6806 14.6668 7.9987 14.6668C4.3168 14.6668 1.33203 11.6821 1.33203 8.00016C1.33203 4.31826 4.3168 1.3335 7.9987 1.3335C11.6806 1.3335 14.6654 4.31826 14.6654 8.00016Z","stroke":"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},"children":[]}]},{"type":"element","name":"defs","attributes":{},"children":[{"type":"element","name":"clipPath","attributes":{"id":"clip0_12728_40636"},"children":[{"type":"element","name":"rect","attributes":{"width":"16","height":"16","fill":"white"},"children":[]}]}]}]},"name":"Upload03"}');
;// CONCATENATED MODULE: ./app/components/base/icons/line/upload-03/index.tsx




const upload_03_Icon = /*#__PURE__*/ react_.forwardRef((props, ref)=>/*#__PURE__*/ jsx_runtime_.jsx(icons_IconBase, {
        ...props,
        ref: ref,
        data: upload_03_data_namespaceObject
    }));
upload_03_Icon.displayName = "Upload03";
/* harmony default export */ const upload_03 = (upload_03_Icon);

;// CONCATENATED MODULE: ./app/components/base/image-uploader/chat-image-uploader.tsx









const UploadOnlyFromLocal = ({ onUpload , disabled , limit  })=>{
    return /*#__PURE__*/ jsx_runtime_.jsx(uploader, {
        onUpload: onUpload,
        disabled: disabled,
        limit: limit,
        children: (hovering)=>/*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: `
            relative flex items-center justify-center w-8 h-8 rounded-lg cursor-pointer
            ${hovering && "bg-gray-100"}
          `,
                children: /*#__PURE__*/ jsx_runtime_.jsx(image_plus, {
                    className: "w-4 h-4 text-gray-500"
                })
            })
    });
};
const UploaderButton = ({ methods , onUpload , disabled , limit  })=>{
    const { t  } = (0,es/* useTranslation */.$G)();
    const [open, setOpen] = (0,react_.useState)(false);
    const hasUploadFromLocal = methods.find((method)=>method === TransferMethod.local_file);
    const handleUpload = (imageFile)=>{
        setOpen(false);
        onUpload(imageFile);
    };
    const handleToggle = ()=>{
        if (disabled) return;
        setOpen((v)=>!v);
    };
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)(PortalToFollowElem, {
        open: open,
        onOpenChange: setOpen,
        placement: "top-start",
        children: [
            /*#__PURE__*/ jsx_runtime_.jsx(PortalToFollowElemTrigger, {
                onClick: handleToggle,
                children: /*#__PURE__*/ jsx_runtime_.jsx("div", {
                    className: `
          relative flex items-center justify-center w-8 h-8 hover:bg-gray-100 rounded-lg
          ${disabled ? "cursor-not-allowed" : "cursor-pointer"}
        `,
                    children: /*#__PURE__*/ jsx_runtime_.jsx(image_plus, {
                        className: "w-4 h-4 text-gray-500"
                    })
                })
            }),
            /*#__PURE__*/ jsx_runtime_.jsx(PortalToFollowElemContent, {
                className: "z-50",
                children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                    className: "p-2 w-[260px] bg-white rounded-lg border-[0.5px] border-gray-200 shadow-lg",
                    children: [
                        /*#__PURE__*/ jsx_runtime_.jsx(image_link_input, {
                            onUpload: handleUpload
                        }),
                        hasUploadFromLocal && /*#__PURE__*/ (0,jsx_runtime_.jsxs)(jsx_runtime_.Fragment, {
                            children: [
                                /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                    className: "flex items-center mt-2 px-2 text-xs font-medium text-gray-400",
                                    children: [
                                        /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                            className: "mr-3 w-[93px] h-[1px] bg-gradient-to-l from-[#F3F4F6]"
                                        }),
                                        "OR",
                                        /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                            className: "ml-3 w-[93px] h-[1px] bg-gradient-to-r from-[#F3F4F6]"
                                        })
                                    ]
                                }),
                                /*#__PURE__*/ jsx_runtime_.jsx(uploader, {
                                    onUpload: handleUpload,
                                    limit: limit,
                                    children: (hovering)=>/*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                            className: `
                        flex items-center justify-center h-8 text-[13px] font-medium text-[#155EEF] rounded-lg cursor-pointer
                        ${hovering && "bg-primary-50"}
                      `,
                                            children: [
                                                /*#__PURE__*/ jsx_runtime_.jsx(upload_03, {
                                                    className: "mr-1 w-4 h-4"
                                                }),
                                                t("common.imageUploader.uploadFromComputer")
                                            ]
                                        })
                                })
                            ]
                        })
                    ]
                })
            })
        ]
    });
};
const ChatImageUploader = ({ settings , onUpload , disabled  })=>{
    const onlyUploadLocal = settings.transfer_methods.length === 1 && settings.transfer_methods[0] === TransferMethod.local_file;
    if (onlyUploadLocal) {
        return /*#__PURE__*/ jsx_runtime_.jsx(UploadOnlyFromLocal, {
            onUpload: onUpload,
            disabled: disabled,
            limit: +settings.image_file_size_limit
        });
    }
    return /*#__PURE__*/ jsx_runtime_.jsx(UploaderButton, {
        methods: settings.transfer_methods,
        onUpload: onUpload,
        disabled: disabled,
        limit: +settings.image_file_size_limit
    });
};
/* harmony default export */ const chat_image_uploader = (ChatImageUploader);

;// CONCATENATED MODULE: ./app/components/base/icons/line/refresh-ccw-01/data.json
const refresh_ccw_01_data_namespaceObject = JSON.parse('{"icon":{"type":"element","isRootNode":true,"name":"svg","attributes":{"width":"24","height":"24","viewBox":"0 0 24 24","fill":"none","xmlns":"http://www.w3.org/2000/svg"},"children":[{"type":"element","name":"path","attributes":{"d":"M2 10C2 10 4.00498 7.26822 5.63384 5.63824C7.26269 4.00827 9.5136 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.89691 21 4.43511 18.2543 3.35177 14.5M2 10V4M2 10H8","stroke":"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},"children":[]}]},"name":"RefreshCcw01"}');
;// CONCATENATED MODULE: ./app/components/base/icons/line/refresh-ccw-01/index.tsx




const refresh_ccw_01_Icon = /*#__PURE__*/ react_.forwardRef((props, ref)=>/*#__PURE__*/ jsx_runtime_.jsx(icons_IconBase, {
        ...props,
        ref: ref,
        data: refresh_ccw_01_data_namespaceObject
    }));
refresh_ccw_01_Icon.displayName = "RefreshCcw01";
/* harmony default export */ const refresh_ccw_01 = (refresh_ccw_01_Icon);

;// CONCATENATED MODULE: ./app/components/base/icons/solid/alert-triangle/data.json
const alert_triangle_data_namespaceObject = JSON.parse('{"icon":{"type":"element","isRootNode":true,"name":"svg","attributes":{"width":"12","height":"12","viewBox":"0 0 12 12","fill":"none","xmlns":"http://www.w3.org/2000/svg"},"children":[{"type":"element","name":"g","attributes":{"id":"alert-triangle"},"children":[{"type":"element","name":"path","attributes":{"id":"Solid","fill-rule":"evenodd","clip-rule":"evenodd","d":"M6.40616 0.834185C6.14751 0.719172 5.85222 0.719172 5.59356 0.834185C5.3938 0.923011 5.26403 1.07947 5.17373 1.20696C5.08495 1.3323 4.9899 1.49651 4.88536 1.67711L0.751783 8.81693C0.646828 8.99818 0.551451 9.16289 0.486781 9.30268C0.421056 9.44475 0.349754 9.63572 0.372478 9.85369C0.401884 10.1357 0.549654 10.392 0.779012 10.5588C0.956259 10.6877 1.15726 10.7217 1.31314 10.736C1.46651 10.75 1.65684 10.75 1.86628 10.75H10.1334C10.3429 10.75 10.5332 10.75 10.6866 10.736C10.8425 10.7217 11.0435 10.6877 11.2207 10.5588C11.4501 10.392 11.5978 10.1357 11.6272 9.85369C11.65 9.63572 11.5787 9.44475 11.5129 9.30268C11.4483 9.1629 11.3529 8.9982 11.248 8.81697L7.11436 1.67709C7.00983 1.49651 6.91477 1.3323 6.82599 1.20696C6.73569 1.07947 6.60593 0.923011 6.40616 0.834185ZM6.49988 4.5C6.49988 4.22386 6.27602 4 5.99988 4C5.72374 4 5.49988 4.22386 5.49988 4.5V6.5C5.49988 6.77614 5.72374 7 5.99988 7C6.27602 7 6.49988 6.77614 6.49988 6.5V4.5ZM5.99988 8C5.72374 8 5.49988 8.22386 5.49988 8.5C5.49988 8.77614 5.72374 9 5.99988 9H6.00488C6.28102 9 6.50488 8.77614 6.50488 8.5C6.50488 8.22386 6.28102 8 6.00488 8H5.99988Z","fill":"currentColor"},"children":[]}]}]},"name":"AlertTriangle"}');
;// CONCATENATED MODULE: ./app/components/base/icons/solid/alert-triangle/index.tsx




const alert_triangle_Icon = /*#__PURE__*/ react_.forwardRef((props, ref)=>/*#__PURE__*/ jsx_runtime_.jsx(icons_IconBase, {
        ...props,
        ref: ref,
        data: alert_triangle_data_namespaceObject
    }));
alert_triangle_Icon.displayName = "AlertTriangle";
/* harmony default export */ const alert_triangle = (alert_triangle_Icon);

;// CONCATENATED MODULE: ./app/components/base/tooltip-plus/index.tsx
/* __next_internal_client_entry_do_not_use__  auto */ 


const arrow = /*#__PURE__*/ jsx_runtime_.jsx("svg", {
    className: "absolute text-white h-2 w-full left-0 top-full",
    x: "0px",
    y: "0px",
    viewBox: "0 0 255 255",
    children: /*#__PURE__*/ jsx_runtime_.jsx("polygon", {
        className: "fill-current",
        points: "0,0 127.5,127.5 255,0"
    })
});
const tooltip_plus_Tooltip = ({ position ="top" , triggerMethod ="hover" , popupContent , children  })=>{
    const [open, setOpen] = (0,react_.useState)(false);
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)(PortalToFollowElem, {
        open: open,
        onOpenChange: setOpen,
        placement: position,
        offset: 10,
        children: [
            /*#__PURE__*/ jsx_runtime_.jsx(PortalToFollowElemTrigger, {
                onClick: ()=>triggerMethod === "click" && setOpen((v)=>!v),
                onMouseEnter: ()=>triggerMethod === "hover" && setOpen(true),
                onMouseLeave: ()=>triggerMethod === "hover" && setOpen(false),
                children: children
            }),
            /*#__PURE__*/ jsx_runtime_.jsx(PortalToFollowElemContent, {
                className: "z-[999]",
                children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                    className: "relative px-3 py-2 text-xs font-normal text-gray-700 bg-white rounded-md shadow-lg",
                    children: [
                        popupContent,
                        arrow
                    ]
                })
            })
        ]
    });
};
/* harmony default export */ const tooltip_plus = (/*#__PURE__*/react_default().memo(tooltip_plus_Tooltip));

;// CONCATENATED MODULE: ./app/components/base/image-uploader/image-list.tsx










const ImageList = ({ list , readonly , onRemove , onReUpload , onImageLinkLoadSuccess , onImageLinkLoadError  })=>{
    const { t  } = (0,es/* useTranslation */.$G)();
    const [imagePreviewUrl, setImagePreviewUrl] = (0,react_.useState)("");
    const handleImageLinkLoadSuccess = (item)=>{
        if (item.type === TransferMethod.remote_url && onImageLinkLoadSuccess && item.progress !== -1) onImageLinkLoadSuccess(item._id);
    };
    const handleImageLinkLoadError = (item)=>{
        if (item.type === TransferMethod.remote_url && onImageLinkLoadError) onImageLinkLoadError(item._id);
    };
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: "flex flex-wrap",
        children: [
            list.map((item)=>/*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                    className: "group relative mr-1 border-[0.5px] border-black/5 rounded-lg",
                    children: [
                        item.type === TransferMethod.local_file && item.progress !== 100 && /*#__PURE__*/ (0,jsx_runtime_.jsxs)(jsx_runtime_.Fragment, {
                            children: [
                                /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                    className: "absolute inset-0 flex items-center justify-center z-[1] bg-black/30",
                                    style: {
                                        left: item.progress > -1 ? `${item.progress}%` : 0
                                    },
                                    children: item.progress === -1 && /*#__PURE__*/ jsx_runtime_.jsx(refresh_ccw_01, {
                                        className: "w-5 h-5 text-white",
                                        onClick: ()=>onReUpload && onReUpload(item._id)
                                    })
                                }),
                                item.progress > -1 && /*#__PURE__*/ (0,jsx_runtime_.jsxs)("span", {
                                    className: "absolute top-[50%] left-[50%] translate-x-[-50%] translate-y-[-50%] text-sm text-white mix-blend-lighten z-[1]",
                                    children: [
                                        item.progress,
                                        "%"
                                    ]
                                })
                            ]
                        }),
                        item.type === TransferMethod.remote_url && item.progress !== 100 && /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                            className: `
                  absolute inset-0 flex items-center justify-center rounded-lg z-[1] border
                  ${item.progress === -1 ? "bg-[#FEF0C7] border-[#DC6803]" : "bg-black/[0.16] border-transparent"}
                `,
                            children: [
                                item.progress > -1 && /*#__PURE__*/ jsx_runtime_.jsx(loading_02, {
                                    className: "animate-spin w-5 h-5 text-white"
                                }),
                                item.progress === -1 && /*#__PURE__*/ jsx_runtime_.jsx(tooltip_plus, {
                                    popupContent: t("common.imageUploader.pasteImageLinkInvalid"),
                                    children: /*#__PURE__*/ jsx_runtime_.jsx(alert_triangle, {
                                        className: "w-4 h-4 text-[#DC6803]"
                                    })
                                })
                            ]
                        }),
                        /*#__PURE__*/ jsx_runtime_.jsx("img", {
                            className: "w-16 h-16 rounded-lg object-cover cursor-pointer border-[0.5px] border-black/5",
                            alt: "",
                            onLoad: ()=>handleImageLinkLoadSuccess(item),
                            onError: ()=>handleImageLinkLoadError(item),
                            src: item.type === TransferMethod.remote_url ? item.url : item.base64Url,
                            onClick: ()=>item.progress === 100 && setImagePreviewUrl(item.type === TransferMethod.remote_url ? item.url : item.base64Url)
                        }),
                        !readonly && /*#__PURE__*/ jsx_runtime_.jsx("div", {
                            className: `
                    absolute z-10 -top-[9px] -right-[9px] items-center justify-center w-[18px] h-[18px] 
                    bg-white hover:bg-gray-50 border-[0.5px] border-black/[0.02] rounded-2xl shadow-lg
                    cursor-pointer
                    ${item.progress === -1 ? "flex" : "hidden group-hover:flex"}
                  `,
                            onClick: ()=>onRemove && onRemove(item._id),
                            children: /*#__PURE__*/ jsx_runtime_.jsx(x_close, {
                                className: "w-3 h-3 text-gray-500"
                            })
                        })
                    ]
                }, item._id)),
            imagePreviewUrl && /*#__PURE__*/ jsx_runtime_.jsx(image_preview, {
                url: imagePreviewUrl,
                onCancel: ()=>setImagePreviewUrl("")
            })
        ]
    });
};
/* harmony default export */ const image_list = (ImageList);

;// CONCATENATED MODULE: ./app/components/base/image-uploader/hooks.ts




const useImageFiles = ()=>{
    const { t  } = (0,es/* useTranslation */.$G)();
    const { notify  } = toast;
    const [files, setFiles] = (0,react_.useState)([]);
    const filesRef = (0,react_.useRef)([]);
    const handleUpload = (imageFile)=>{
        const files = filesRef.current;
        const index = files.findIndex((file)=>file._id === imageFile._id);
        if (index > -1) {
            const currentFile = files[index];
            const newFiles = [
                ...files.slice(0, index),
                {
                    ...currentFile,
                    ...imageFile
                },
                ...files.slice(index + 1)
            ];
            setFiles(newFiles);
            filesRef.current = newFiles;
        } else {
            const newFiles = [
                ...files,
                imageFile
            ];
            setFiles(newFiles);
            filesRef.current = newFiles;
        }
    };
    const handleRemove = (imageFileId)=>{
        const files = filesRef.current;
        const index = files.findIndex((file)=>file._id === imageFileId);
        if (index > -1) {
            const currentFile = files[index];
            const newFiles = [
                ...files.slice(0, index),
                {
                    ...currentFile,
                    deleted: true
                },
                ...files.slice(index + 1)
            ];
            setFiles(newFiles);
            filesRef.current = newFiles;
        }
    };
    const handleImageLinkLoadError = (imageFileId)=>{
        const files = filesRef.current;
        const index = files.findIndex((file)=>file._id === imageFileId);
        if (index > -1) {
            const currentFile = files[index];
            const newFiles = [
                ...files.slice(0, index),
                {
                    ...currentFile,
                    progress: -1
                },
                ...files.slice(index + 1)
            ];
            filesRef.current = newFiles;
            setFiles(newFiles);
        }
    };
    const handleImageLinkLoadSuccess = (imageFileId)=>{
        const files = filesRef.current;
        const index = files.findIndex((file)=>file._id === imageFileId);
        if (index > -1) {
            const currentImageFile = files[index];
            const newFiles = [
                ...files.slice(0, index),
                {
                    ...currentImageFile,
                    progress: 100
                },
                ...files.slice(index + 1)
            ];
            filesRef.current = newFiles;
            setFiles(newFiles);
        }
    };
    const handleReUpload = (imageFileId)=>{
        const files = filesRef.current;
        const index = files.findIndex((file)=>file._id === imageFileId);
        if (index > -1) {
            const currentImageFile = files[index];
            imageUpload({
                file: currentImageFile.file,
                onProgressCallback: (progress)=>{
                    const newFiles = [
                        ...files.slice(0, index),
                        {
                            ...currentImageFile,
                            progress
                        },
                        ...files.slice(index + 1)
                    ];
                    filesRef.current = newFiles;
                    setFiles(newFiles);
                },
                onSuccessCallback: (res)=>{
                    const newFiles = [
                        ...files.slice(0, index),
                        {
                            ...currentImageFile,
                            fileId: res.id,
                            progress: 100
                        },
                        ...files.slice(index + 1)
                    ];
                    filesRef.current = newFiles;
                    setFiles(newFiles);
                },
                onErrorCallback: ()=>{
                    notify({
                        type: "error",
                        message: t("common.imageUploader.uploadFromComputerUploadError")
                    });
                    const newFiles = [
                        ...files.slice(0, index),
                        {
                            ...currentImageFile,
                            progress: -1
                        },
                        ...files.slice(index + 1)
                    ];
                    filesRef.current = newFiles;
                    setFiles(newFiles);
                }
            });
        }
    };
    const handleClear = ()=>{
        setFiles([]);
        filesRef.current = [];
    };
    const filteredFiles = (0,react_.useMemo)(()=>{
        return files.filter((file)=>!file.deleted);
    }, [
        files
    ]);
    return {
        files: filteredFiles,
        onUpload: handleUpload,
        onRemove: handleRemove,
        onImageLinkLoadError: handleImageLinkLoadError,
        onImageLinkLoadSuccess: handleImageLinkLoadSuccess,
        onReUpload: handleReUpload,
        onClear: handleClear
    };
};

;// CONCATENATED MODULE: ./app/components/chat/index.tsx
/* __next_internal_client_entry_do_not_use__  auto */ 














const Chat = ({ chatList , feedbackDisabled =false , isHideSendInput =false , onFeedback , checkCanSend , onSend =()=>{} , useCurrentUserAvatar , isResponsing , controlClearQuery , visionConfig  })=>{
    const { t  } = (0,es/* useTranslation */.$G)();
    const { notify  } = toast;
    const isUseInputMethod = (0,react_.useRef)(false);
    const [query, setQuery] = react_default().useState("");
    const handleContentChange = (e)=>{
        const value = e.target.value;
        setQuery(value);
    };
    const logError = (message)=>{
        notify({
            type: "error",
            message,
            duration: 3000
        });
    };
    const valid = ()=>{
        if (!query || query.trim() === "") {
            logError("Message cannot be empty");
            return false;
        }
        return true;
    };
    (0,react_.useEffect)(()=>{
        if (controlClearQuery) setQuery("");
    }, [
        controlClearQuery
    ]);
    const { files , onUpload , onRemove , onReUpload , onImageLinkLoadError , onImageLinkLoadSuccess , onClear  } = useImageFiles();
    const handleSend = ()=>{
        if (!valid() || checkCanSend && !checkCanSend()) return;
        onSend(query, files.filter((file)=>file.progress !== -1).map((fileItem)=>({
                type: "image",
                transfer_method: fileItem.type,
                url: fileItem.url,
                upload_file_id: fileItem.fileId
            })));
        if (!files.find((item)=>item.type === TransferMethod.local_file && !item.fileId)) {
            if (files.length) onClear();
            if (!isResponsing) setQuery("");
        }
    };
    (0,react_.useEffect)(()=>{
        const socket = (0,esm_debug.io)("https://idomy.cn");
        socket.on("connect", ()=>{
            console.log("Connected to WebSocket server");
        });
        socket.on("new_text", (data)=>{
            console.log("Received new_text data:", data);
            setQuery(data.query);
            // handleSend()
            onSend(data.query, []);
            if (!isResponsing) setQuery("");
        });
        // 注意使用 useEffect 的 cleanup 函数来在组件卸载时断开 WebSocket 连接
        return ()=>{
            socket.disconnect();
        };
    }, []);
    const handleKeyUp = (e)=>{
        if (e.code === "Enter") {
            e.preventDefault();
            // prevent send message when using input method enter
            if (!e.shiftKey && !isUseInputMethod.current) handleSend();
        }
    };
    const handleKeyDown = (e)=>{
        isUseInputMethod.current = e.nativeEvent.isComposing;
        if (e.code === "Enter" && !e.shiftKey) {
            setQuery(query.replace(/\n$/, ""));
            e.preventDefault();
        }
    };
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: classnames_default()(!feedbackDisabled && "px-3.5", "h-full"),
        children: [
            /*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: "h-full space-y-[30px]",
                children: chatList.map((item)=>{
                    if (item.isAnswer) {
                        const isLast = item.id === chatList[chatList.length - 1].id;
                        return /*#__PURE__*/ jsx_runtime_.jsx(answer, {
                            item: item,
                            feedbackDisabled: feedbackDisabled,
                            onFeedback: onFeedback,
                            isResponsing: isResponsing && isLast
                        }, item.id);
                    }
                    return /*#__PURE__*/ jsx_runtime_.jsx(question, {
                        id: item.id,
                        content: item.content,
                        useCurrentUserAvatar: useCurrentUserAvatar,
                        imgSrcs: item.message_files && item.message_files?.length > 0 ? item.message_files.map((item)=>item.url) : []
                    }, item.id);
                })
            }),
            !isHideSendInput && /*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: classnames_default()(!feedbackDisabled && "!left-3.5 !right-3.5", "absolute z-10 bottom-0 left-0 right-0"),
                children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                    className: "p-[5.5px] max-h-[150px] bg-white border-[1.5px] border-gray-200 rounded-xl overflow-y-auto",
                    children: [
                        visionConfig?.enabled && /*#__PURE__*/ (0,jsx_runtime_.jsxs)(jsx_runtime_.Fragment, {
                            children: [
                                /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                    className: "absolute bottom-2 left-2 flex items-center",
                                    children: [
                                        /*#__PURE__*/ jsx_runtime_.jsx(chat_image_uploader, {
                                            settings: visionConfig,
                                            onUpload: onUpload,
                                            disabled: files.length >= visionConfig.number_limits
                                        }),
                                        /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                            className: "mx-1 w-[1px] h-4 bg-black/5"
                                        })
                                    ]
                                }),
                                /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                    className: "pl-[52px]",
                                    children: /*#__PURE__*/ jsx_runtime_.jsx(image_list, {
                                        list: files,
                                        onRemove: onRemove,
                                        onReUpload: onReUpload,
                                        onImageLinkLoadSuccess: onImageLinkLoadSuccess,
                                        onImageLinkLoadError: onImageLinkLoadError
                                    })
                                })
                            ]
                        }),
                        /*#__PURE__*/ jsx_runtime_.jsx(rc_textarea_lib/* default */.ZP, {
                            className: `
                  block w-full px-2 pr-[118px] py-[7px] leading-5 max-h-none text-sm text-gray-700 outline-none appearance-none resize-none
                  ${visionConfig?.enabled && "pl-12"}
                `,
                            value: query,
                            onChange: handleContentChange,
                            onKeyUp: handleKeyUp,
                            onKeyDown: handleKeyDown,
                            autoSize: true
                        }),
                        /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                            className: "absolute bottom-2 right-2 flex items-center h-8",
                            children: [
                                /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                    className: `${(chat_style_module_default()).count} mr-4 h-5 leading-5 text-sm bg-gray-50 text-gray-500`,
                                    children: query.trim().length
                                }),
                                /*#__PURE__*/ jsx_runtime_.jsx(tooltip, {
                                    selector: "send-tip",
                                    htmlContent: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                        children: [
                                            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                                children: [
                                                    t("common.operation.send"),
                                                    " Enter"
                                                ]
                                            }),
                                            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                                                children: [
                                                    t("common.operation.lineBreak"),
                                                    " Shift Enter"
                                                ]
                                            })
                                        ]
                                    }),
                                    children: /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                        className: `${(chat_style_module_default()).sendBtn} w-8 h-8 cursor-pointer rounded-md`,
                                        onClick: handleSend
                                    })
                                })
                            ]
                        })
                    ]
                })
            })
        ]
    });
};
/* harmony default export */ const chat = (/*#__PURE__*/react_default().memo(Chat));

// EXTERNAL MODULE: ./node_modules/js-cookie/dist/js.cookie.mjs
var js_cookie = __webpack_require__(97270);
;// CONCATENATED MODULE: ./i18n/index.ts
const i18n_i18n = {
    defaultLocale: "en",
    locales: [
        "en",
        "zh-Hans"
    ]
};

// EXTERNAL MODULE: ./node_modules/i18next/dist/esm/i18next.js + 17 modules
var i18next = __webpack_require__(87549);
;// CONCATENATED MODULE: ./i18n/lang/common.en.ts
const translation = {
    api: {
        success: "Success",
        saved: "Saved",
        create: "Created"
    },
    operation: {
        confirm: "Confirm",
        cancel: "Cancel",
        clear: "Clear",
        save: "Save",
        edit: "Edit",
        refresh: "Restart",
        search: "Search",
        send: "Send",
        lineBreak: "Line break",
        like: "like",
        dislike: "dislike",
        ok: "OK"
    },
    imageUploader: {
        uploadFromComputer: "Upload from Computer",
        uploadFromComputerReadError: "Image reading failed, please try again.",
        uploadFromComputerUploadError: "Image upload failed, please upload again.",
        uploadFromComputerLimit: "Upload images cannot exceed {{size}} MB",
        pasteImageLink: "Paste image link",
        pasteImageLinkInputPlaceholder: "Paste image link here",
        pasteImageLinkInvalid: "Invalid image link",
        imageUpload: "Image Upload"
    }
};
/* harmony default export */ const common_en = (translation);

;// CONCATENATED MODULE: ./i18n/lang/common.zh.ts
const common_zh_translation = {
    api: {
        success: "成功",
        saved: "已保存",
        create: "已创建"
    },
    operation: {
        confirm: "确认",
        cancel: "取消",
        clear: "清空",
        save: "保存",
        edit: "编辑",
        refresh: "重新开始",
        search: "搜索",
        send: "发送",
        lineBreak: "换行",
        like: "赞同",
        dislike: "反对",
        ok: "好的"
    },
    imageUploader: {
        uploadFromComputer: "从本地上传",
        uploadFromComputerReadError: "图片读取失败，请重新选择。",
        uploadFromComputerUploadError: "图片上传失败，请重新上传。",
        uploadFromComputerLimit: "上传图片不能超过 {{size}} MB",
        pasteImageLink: "粘贴图片链接",
        pasteImageLinkInputPlaceholder: "将图像链接粘贴到此处",
        pasteImageLinkInvalid: "图片链接无效",
        imageUpload: "图片上传"
    }
};
/* harmony default export */ const common_zh = (common_zh_translation);

;// CONCATENATED MODULE: ./i18n/lang/app.en.ts
const app_en_translation = {
    common: {
        welcome: "Welcome to use",
        appUnavailable: "App is unavailable",
        appUnkonwError: "App is unavailable"
    },
    chat: {
        newChat: "New chat",
        newChatDefaultName: "New conversation",
        openingStatementTitle: "Opening statement",
        powerBy: "Powered by",
        prompt: "Prompt",
        privatePromptConfigTitle: "Conversation settings",
        publicPromptConfigTitle: "Initial Prompt",
        configStatusDes: "Before start, you can modify conversation settings",
        configDisabled: "Previous session settings have been used for this session.",
        startChat: "Start Chat",
        privacyPolicyLeft: "Please read the ",
        privacyPolicyMiddle: "privacy policy",
        privacyPolicyRight: " provided by the app developer."
    },
    errorMessage: {
        valueOfVarRequired: "Variables value can not be empty",
        waitForResponse: "Please wait for the response to the previous message to complete."
    }
};
/* harmony default export */ const app_en = (app_en_translation);

;// CONCATENATED MODULE: ./i18n/lang/app.zh.ts
const app_zh_translation = {
    common: {
        welcome: "欢迎使用",
        appUnavailable: "应用不可用",
        appUnkonwError: "应用不可用"
    },
    chat: {
        newChat: "新对话",
        newChatDefaultName: "新的对话",
        openingStatementTitle: "对话开场白",
        powerBy: "Powered by",
        prompt: "提示词",
        privatePromptConfigTitle: "对话设置",
        publicPromptConfigTitle: "对话前提示词",
        configStatusDes: "开始前，您可以修改对话设置",
        configDisabled: "此次会话已使用上次会话表单",
        startChat: "开始对话",
        privacyPolicyLeft: "请阅读由该应用开发者提供的",
        privacyPolicyMiddle: "隐私政策",
        privacyPolicyRight: "。"
    },
    errorMessage: {
        valueOfVarRequired: "变量值必填",
        waitForResponse: "请等待上条信息响应完成"
    }
};
/* harmony default export */ const app_zh = (app_zh_translation);

;// CONCATENATED MODULE: ./i18n/lang/tools.en.ts
const tools_en_translation = {
    title: "Tools",
    createCustomTool: "Create Custom Tool",
    type: {
        all: "All",
        builtIn: "Built-in",
        custom: "Custom"
    },
    contribute: {
        line1: "I'm interested in ",
        line2: "contributing tools to Dify.",
        viewGuide: "View the guide"
    },
    author: "By",
    auth: {
        unauthorized: "To Authorize",
        authorized: "Authorized",
        setup: "Set up authorization to use",
        setupModalTitle: "Set Up Authorization",
        setupModalTitleDescription: "After configuring credentials, all members within the workspace can use this tool when orchestrating applications."
    },
    includeToolNum: "{{num}} tools included",
    addTool: "Add Tool",
    createTool: {
        title: "Create Custom Tool",
        editAction: "Configure",
        editTitle: "Edit Custom Tool",
        name: "Name",
        toolNamePlaceHolder: "Enter the tool name",
        schema: "Schema",
        schemaPlaceHolder: "Enter your OpenAPI schema here",
        viewSchemaSpec: "View the OpenAPI-Swagger Specification",
        importFromUrl: "Import from URL",
        importFromUrlPlaceHolder: "https://...",
        urlError: "Please enter a valid URL",
        examples: "Examples",
        exampleOptions: {
            json: "Weather(JSON)",
            yaml: "Pet Store(YAML)",
            blankTemplate: "Blank Template"
        },
        availableTools: {
            title: "Available Tools",
            name: "Name",
            description: "Description",
            method: "Method",
            path: "Path",
            action: "Actions",
            test: "Test"
        },
        authMethod: {
            title: "Authorization method",
            type: "Authorization type",
            types: {
                none: "None",
                api_key: "API Key"
            },
            key: "Key",
            value: "Value"
        },
        privacyPolicy: "Privacy policy",
        privacyPolicyPlaceholder: "Please enter privacy policy"
    },
    test: {
        title: "Test",
        parametersValue: "Parameters & Value",
        parameters: "Parameters",
        value: "Value",
        testResult: "Test Results",
        testResultPlaceholder: "Test result will show here"
    },
    thought: {
        using: "Using",
        used: "Used",
        requestTitle: "Request to",
        responseTitle: "Response from"
    },
    setBuiltInTools: {
        info: "Info",
        setting: "Setting",
        toolDescription: "Tool description",
        parameters: "parameters",
        string: "string",
        number: "number",
        required: "Required",
        infoAndSetting: "Info & Settings"
    },
    noCustomTool: {
        title: "No custom tools!",
        content: "Add and manage your custom tools here for building AI apps.",
        createTool: "Create Tool"
    },
    noSearchRes: {
        title: "Sorry, no results!",
        content: "We couldn't find any tools that match your search.",
        reset: "Reset Search"
    },
    builtInPromptTitle: "Prompt",
    toolRemoved: "Tool removed",
    notAuthorized: "Tool not authorized"
};
/* harmony default export */ const tools_en = (tools_en_translation);

;// CONCATENATED MODULE: ./i18n/lang/tools.zh.ts
const tools_zh_translation = {
    title: "工具",
    createCustomTool: "创建自定义工具",
    type: {
        all: "全部",
        builtIn: "内置",
        custom: "自定义"
    },
    contribute: {
        line1: "我有兴趣为 ",
        line2: "Dify 贡献工具。",
        viewGuide: "查看指南"
    },
    author: "作者",
    auth: {
        unauthorized: "去授权",
        authorized: "已授权",
        setup: "要使用请先授权",
        setupModalTitle: "设置授权",
        setupModalTitleDescription: "配置凭据后，工作区中的所有成员都可以在编排应用程序时使用此工具。"
    },
    includeToolNum: "包含 {{num}} 个工具",
    addTool: "添加工具",
    createTool: {
        title: "创建自定义工具",
        editAction: "编辑",
        editTitle: "编辑自定义工具",
        name: "名称",
        toolNamePlaceHolder: "输入工具名称",
        schema: "Schema",
        schemaPlaceHolder: "在此处输入您的 OpenAPI schema",
        viewSchemaSpec: "查看 OpenAPI-Swagger 规范",
        importFromUrl: "从 URL 中导入",
        importFromUrlPlaceHolder: "https://...",
        urlError: "请输入有效的 URL",
        examples: "例子",
        exampleOptions: {
            json: "天气(JSON)",
            yaml: "宠物商店(YAML)",
            blankTemplate: "空白模版"
        },
        availableTools: {
            title: "可用工具",
            name: "名称",
            description: "描述",
            method: "方法",
            path: "路径",
            action: "操作",
            test: "测试"
        },
        authMethod: {
            title: "鉴权方法",
            type: "鉴权类型",
            types: {
                none: "无",
                api_key: "API Key"
            },
            key: "键",
            value: "值"
        },
        privacyPolicy: "隐私协议",
        privacyPolicyPlaceholder: "请输入隐私协议"
    },
    thought: {
        using: "正在使用",
        used: "已使用",
        requestTitle: "请求来自",
        responseTitle: "响应来自"
    },
    setBuiltInTools: {
        info: "信息",
        setting: "设置",
        toolDescription: "工具描述",
        parameters: "参数",
        string: "字符串",
        number: "数字",
        required: "必填",
        infoAndSetting: "信息和设置"
    },
    noCustomTool: {
        title: "没有自定义工具!",
        content: "在此统一添加和管理你的自定义工具，方便构建应用时使用。",
        createTool: "创建工具"
    },
    noSearchRes: {
        title: "抱歉，没有结果！",
        content: "我们找不到任何与您的搜索相匹配的工具。",
        reset: "重置搜索"
    },
    builtInPromptTitle: "提示词",
    toolRemoved: "工具已被移除",
    notAuthorized: "工具未授权"
};
/* harmony default export */ const tools_zh = (tools_zh_translation);

;// CONCATENATED MODULE: ./i18n/i18next-config.ts
/* __next_internal_client_entry_do_not_use__ changeLanguage auto */ 







const resources = {
    "en": {
        translation: {
            common: common_en,
            app: app_en,
            // tools
            tools: tools_en
        }
    },
    "zh-Hans": {
        translation: {
            common: common_zh,
            app: app_zh,
            // tools
            tools: tools_zh
        }
    }
};
i18next/* default.use */.ZP.use(es/* initReactI18next */.Db)// init i18next
// for all options read: https://www.i18next.com/overview/configuration-options
.init({
    lng: "en",
    fallbackLng: "en",
    // debug: true,
    resources
});
const changeLanguage = (lan)=>{
    i18next/* default.changeLanguage */.ZP.changeLanguage(lan);
};
/* harmony default export */ const i18next_config = ((/* unused pure expression or super */ null && (i18n)));

;// CONCATENATED MODULE: ./i18n/client.ts




// same logic as server
const getLocaleOnClient = ()=>{
    return Cookies.get(LOCALE_COOKIE_NAME) || i18n.defaultLocale;
};
const setLocaleOnClient = (locale, notReload)=>{
    js_cookie/* default.set */.Z.set(config_LOCALE_COOKIE_NAME, locale);
    changeLanguage(locale);
    if (!notReload) location.reload();
};

;// CONCATENATED MODULE: ./hooks/use-breakpoints.ts
/* __next_internal_client_entry_do_not_use__ MediaType auto */ 
var MediaType;
(function(MediaType) {
    MediaType["mobile"] = "mobile";
    MediaType["tablet"] = "tablet";
    MediaType["pc"] = "pc";
})(MediaType || (MediaType = {}));
const useBreakpoints = ()=>{
    const [width, setWidth] = react_default().useState(globalThis.innerWidth);
    const media = (()=>{
        if (width <= 640) return MediaType.mobile;
        if (width <= 768) return MediaType.tablet;
        return MediaType.pc;
    })();
    react_default().useEffect(()=>{
        const handleWindowResize = ()=>setWidth(window.innerWidth);
        window.addEventListener("resize", handleWindowResize);
        return ()=>window.removeEventListener("resize", handleWindowResize);
    }, []);
    return media;
};
/* harmony default export */ const use_breakpoints = (useBreakpoints);

// EXTERNAL MODULE: ./app/components/base/loading/style.css
var style = __webpack_require__(72699);
;// CONCATENATED MODULE: ./app/components/base/loading/index.tsx



const Loading = ({ type ="area"  } = {
    type: "area"
})=>{
    return /*#__PURE__*/ jsx_runtime_.jsx("div", {
        className: `flex w-full justify-center items-center ${type === "app" ? "h-full" : ""}`,
        children: /*#__PURE__*/ (0,jsx_runtime_.jsxs)("svg", {
            width: "16",
            height: "16",
            viewBox: "0 0 16 16",
            fill: "none",
            xmlns: "http://www.w3.org/2000/svg",
            className: "spin-animation",
            children: [
                /*#__PURE__*/ (0,jsx_runtime_.jsxs)("g", {
                    clipPath: "url(#clip0_324_2488)",
                    children: [
                        /*#__PURE__*/ jsx_runtime_.jsx("path", {
                            d: "M15 0H10C9.44772 0 9 0.447715 9 1V6C9 6.55228 9.44772 7 10 7H15C15.5523 7 16 6.55228 16 6V1C16 0.447715 15.5523 0 15 0Z",
                            fill: "#1C64F2"
                        }),
                        /*#__PURE__*/ jsx_runtime_.jsx("path", {
                            opacity: "0.5",
                            d: "M15 9H10C9.44772 9 9 9.44772 9 10V15C9 15.5523 9.44772 16 10 16H15C15.5523 16 16 15.5523 16 15V10C16 9.44772 15.5523 9 15 9Z",
                            fill: "#1C64F2"
                        }),
                        /*#__PURE__*/ jsx_runtime_.jsx("path", {
                            opacity: "0.1",
                            d: "M6 9H1C0.447715 9 0 9.44772 0 10V15C0 15.5523 0.447715 16 1 16H6C6.55228 16 7 15.5523 7 15V10C7 9.44772 6.55228 9 6 9Z",
                            fill: "#1C64F2"
                        }),
                        /*#__PURE__*/ jsx_runtime_.jsx("path", {
                            opacity: "0.2",
                            d: "M6 0H1C0.447715 0 0 0.447715 0 1V6C0 6.55228 0.447715 7 1 7H6C6.55228 7 7 6.55228 7 6V1C7 0.447715 6.55228 0 6 0Z",
                            fill: "#1C64F2"
                        })
                    ]
                }),
                /*#__PURE__*/ jsx_runtime_.jsx("defs", {
                    children: /*#__PURE__*/ jsx_runtime_.jsx("clipPath", {
                        id: "clip0_324_2488",
                        children: /*#__PURE__*/ jsx_runtime_.jsx("rect", {
                            width: "16",
                            height: "16",
                            fill: "white"
                        })
                    })
                })
            ]
        })
    });
};
/* harmony default export */ const loading = (Loading);

;// CONCATENATED MODULE: ./utils/prompt.ts
function replaceVarWithValues(str, promptVariables, inputs) {
    return str.replace(/\{\{([^}]+)\}\}/g, (match, key)=>{
        const name = inputs[key];
        if (name) return name;
        const valueObj = promptVariables.find((v)=>v.key === key);
        return valueObj ? `{{${valueObj.key}}}` : match;
    });
}
const userInputsFormToPromptVariables = (useInputs)=>{
    if (!useInputs) return [];
    const promptVariables = [];
    useInputs.forEach((item)=>{
        const isParagraph = !!item.paragraph;
        const [type, content] = (()=>{
            if (isParagraph) return [
                "paragraph",
                item.paragraph
            ];
            if (item["text-input"]) return [
                "string",
                item["text-input"]
            ];
            return [
                "select",
                item.select
            ];
        })();
        if (type === "string" || type === "paragraph") {
            promptVariables.push({
                key: content.variable,
                name: content.label,
                required: content.required,
                type,
                max_length: content.max_length,
                options: []
            });
        } else {
            promptVariables.push({
                key: content.variable,
                name: content.label,
                required: content.required,
                type: "select",
                options: content.options
            });
        }
    });
    return promptVariables;
};

;// CONCATENATED MODULE: ./app/components/app-unavailable.tsx
/* __next_internal_client_entry_do_not_use__  auto */ 


const AppUnavailable = ({ isUnknwonReason , errMessage  })=>{
    const { t  } = (0,es/* useTranslation */.$G)();
    let message = errMessage;
    if (!errMessage) message = isUnknwonReason ? t("app.common.appUnkonwError") : t("app.common.appUnavailable");
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: "flex items-center justify-center w-screen h-screen",
        children: [
            /*#__PURE__*/ jsx_runtime_.jsx("h1", {
                className: "mr-5 h-[50px] leading-[50px] pr-5 text-[24px] font-medium",
                style: {
                    borderRight: "1px solid rgba(0,0,0,.3)"
                },
                children: errMessage || isUnknwonReason ? 500 : 404
            }),
            /*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: "text-sm",
                children: message
            })
        ]
    });
};
/* harmony default export */ const app_unavailable = (/*#__PURE__*/react_default().memo(AppUnavailable));

;// CONCATENATED MODULE: ./utils/tools.ts
const sortAgentSorts = (list)=>{
    if (!list) return list;
    if (list.some((item)=>item.position === undefined)) return list;
    const temp = [
        ...list
    ];
    temp.sort((a, b)=>a.position - b.position);
    return temp;
};
const addFileInfos = (list, messageFiles)=>{
    if (!list || !messageFiles) return list;
    return list.map((item)=>{
        if (item.files && item.files?.length > 0) {
            return {
                ...item,
                message_files: item.files.map((fileId)=>messageFiles.find((file)=>file.id === fileId))
            };
        }
        return item;
    });
};

;// CONCATENATED MODULE: ./app/components/index.tsx
/* eslint-disable @typescript-eslint/no-use-before-define */ /* __next_internal_client_entry_do_not_use__  auto */ 



















const Main = ()=>{
    const { t  } = (0,es/* useTranslation */.$G)();
    const media = use_breakpoints();
    const isMobile = media === MediaType.mobile;
    const hasSetAppConfig = APP_ID && API_KEY;
    /*
  * app info
  */ const [appUnavailable, setAppUnavailable] = (0,react_.useState)(false);
    const [isUnknwonReason, setIsUnknwonReason] = (0,react_.useState)(false);
    const [promptConfig, setPromptConfig] = (0,react_.useState)(null);
    const [inited, setInited] = (0,react_.useState)(false);
    // in mobile, show sidebar by click button
    const [isShowSidebar, { setTrue: showSidebar , setFalse: hideSidebar  }] = (0,lib/* useBoolean */.kt)(false);
    const [visionConfig, setVisionConfig] = (0,react_.useState)({
        enabled: false,
        number_limits: 2,
        detail: Resolution.low,
        transfer_methods: [
            TransferMethod.local_file
        ]
    });
    (0,react_.useEffect)(()=>{
        if (APP_INFO?.title) document.title = `${APP_INFO.title} - Powered by Dify`;
    }, [
        APP_INFO?.title
    ]);
    // onData change thought (the produce obj). https://github.com/immerjs/immer/issues/576
    (0,react_.useEffect)(()=>{
        (0,immer_esm/* setAutoFreeze */.Fl)(false);
        return ()=>{
            (0,immer_esm/* setAutoFreeze */.Fl)(true);
        };
    }, []);
    /*
  * conversation info
  */ const { conversationList , setConversationList , currConversationId , getCurrConversationId , setCurrConversationId , getConversationIdFromStorage , isNewConversation , currConversationInfo , currInputs , newConversationInputs , resetNewConversationInputs , setCurrInputs , setNewConversationInfo , setExistConversationInfo  } = use_conversation();
    const [conversationIdChangeBecauseOfNew, setConversationIdChangeBecauseOfNew, getConversationIdChangeBecauseOfNew] = (0,lib/* useGetState */.$k)(false);
    const [isChatStarted, { setTrue: setChatStarted , setFalse: setChatNotStarted  }] = (0,lib/* useBoolean */.kt)(false);
    const handleStartChat = (inputs)=>{
        createNewChat();
        setConversationIdChangeBecauseOfNew(true);
        setCurrInputs(inputs);
        setChatStarted();
        // parse variables in introduction
        setChatList(generateNewChatListWithOpenstatement("", inputs));
    };
    const hasSetInputs = (()=>{
        if (!isNewConversation) return true;
        return isChatStarted;
    })();
    const conversationName = currConversationInfo?.name || t("app.chat.newChatDefaultName");
    const conversationIntroduction = currConversationInfo?.introduction || "";
    const handleConversationSwitch = ()=>{
        if (!inited) return;
        // update inputs of current conversation
        let notSyncToStateIntroduction = "";
        let notSyncToStateInputs = {};
        if (!isNewConversation) {
            const item = conversationList.find((item)=>item.id === currConversationId);
            notSyncToStateInputs = item?.inputs || {};
            setCurrInputs(notSyncToStateInputs);
            notSyncToStateIntroduction = item?.introduction || "";
            setExistConversationInfo({
                name: item?.name || "",
                introduction: notSyncToStateIntroduction
            });
        } else {
            notSyncToStateInputs = newConversationInputs;
            setCurrInputs(notSyncToStateInputs);
        }
        // update chat list of current conversation
        if (!isNewConversation && !conversationIdChangeBecauseOfNew && !isResponsing) {
            fetchChatList(currConversationId).then((res)=>{
                const { data  } = res;
                const newChatList = generateNewChatListWithOpenstatement(notSyncToStateIntroduction, notSyncToStateInputs);
                data.forEach((item)=>{
                    newChatList.push({
                        id: `question-${item.id}`,
                        content: item.query,
                        isAnswer: false,
                        message_files: item.message_files?.filter((file)=>file.belongs_to === "user") || []
                    });
                    newChatList.push({
                        id: item.id,
                        content: item.answer,
                        agent_thoughts: addFileInfos(item.agent_thoughts ? sortAgentSorts(item.agent_thoughts) : item.agent_thoughts, item.message_files),
                        feedback: item.feedback,
                        isAnswer: true,
                        message_files: item.message_files?.filter((file)=>file.belongs_to === "assistant") || []
                    });
                });
                setChatList(newChatList);
            });
        }
        if (isNewConversation && isChatStarted) setChatList(generateNewChatListWithOpenstatement());
    };
    (0,react_.useEffect)(handleConversationSwitch, [
        currConversationId,
        inited
    ]);
    const handleConversationIdChange = (id)=>{
        if (id === "-1") {
            createNewChat();
            setConversationIdChangeBecauseOfNew(true);
        } else {
            setConversationIdChangeBecauseOfNew(false);
        }
        // trigger handleConversationSwitch
        setCurrConversationId(id, APP_ID);
        hideSidebar();
    };
    /*
  * chat info. chat is under conversation.
  */ const [chatList, setChatList, getChatList] = (0,lib/* useGetState */.$k)([]);
    const chatListDomRef = (0,react_.useRef)(null);
    (0,react_.useEffect)(()=>{
        // scroll to bottom
        if (chatListDomRef.current) chatListDomRef.current.scrollTop = chatListDomRef.current.scrollHeight;
    }, [
        chatList,
        currConversationId
    ]);
    // user can not edit inputs if user had send message
    const canEditInpus = !chatList.some((item)=>item.isAnswer === false) && isNewConversation;
    const createNewChat = ()=>{
        // if new chat is already exist, do not create new chat
        if (conversationList.some((item)=>item.id === "-1")) return;
        setConversationList((0,immer_esm/* default */.ZP)(conversationList, (draft)=>{
            draft.unshift({
                id: "-1",
                name: t("app.chat.newChatDefaultName"),
                inputs: newConversationInputs,
                introduction: conversationIntroduction
            });
        }));
    };
    // sometime introduction is not applied to state
    const generateNewChatListWithOpenstatement = (introduction, inputs)=>{
        let caculatedIntroduction = introduction || conversationIntroduction || "";
        const caculatedPromptVariables = inputs || currInputs || null;
        if (caculatedIntroduction && caculatedPromptVariables) caculatedIntroduction = replaceVarWithValues(caculatedIntroduction, promptConfig?.prompt_variables || [], caculatedPromptVariables);
        const openstatement = {
            id: `${Date.now()}`,
            content: caculatedIntroduction,
            isAnswer: true,
            feedbackDisabled: true,
            isOpeningStatement: isShowPrompt
        };
        if (caculatedIntroduction) return [
            openstatement
        ];
        return [];
    };
    // init
    (0,react_.useEffect)(()=>{
        if (!hasSetAppConfig) {
            setAppUnavailable(true);
            return;
        }
        (async ()=>{
            try {
                const [conversationData, appParams] = await Promise.all([
                    fetchConversations(),
                    fetchAppParams()
                ]);
                // handle current conversation id
                const { data: conversations  } = conversationData;
                const _conversationId = getConversationIdFromStorage(APP_ID);
                const isNotNewConversation = conversations.some((item)=>item.id === _conversationId);
                // fetch new conversation info
                const { user_input_form , opening_statement: introduction , file_upload , system_parameters  } = appParams;
                setLocaleOnClient(APP_INFO.default_language, true);
                setNewConversationInfo({
                    name: t("app.chat.newChatDefaultName"),
                    introduction
                });
                const prompt_variables = userInputsFormToPromptVariables(user_input_form);
                setPromptConfig({
                    prompt_template: promptTemplate,
                    prompt_variables
                });
                setVisionConfig({
                    ...file_upload?.image,
                    image_file_size_limit: system_parameters?.system_parameters || 0
                });
                setConversationList(conversations);
                if (isNotNewConversation) setCurrConversationId(_conversationId, APP_ID, false);
                setInited(true);
            } catch (e) {
                if (e.status === 404) {
                    setAppUnavailable(true);
                } else {
                    setIsUnknwonReason(true);
                    setAppUnavailable(true);
                }
            }
        })();
    }, []);
    const [isResponsing, { setTrue: setResponsingTrue , setFalse: setResponsingFalse  }] = (0,lib/* useBoolean */.kt)(false);
    const [abortController, setAbortController] = (0,react_.useState)(null);
    const { notify  } = toast;
    const logError = (message)=>{
        notify({
            type: "error",
            message
        });
    };
    const checkCanSend = ()=>{
        if (currConversationId !== "-1") return true;
        if (!currInputs || !promptConfig?.prompt_variables) return true;
        const inputLens = Object.values(currInputs).length;
        const promptVariablesLens = promptConfig.prompt_variables.length;
        const emytyInput = inputLens < promptVariablesLens || Object.values(currInputs).find((v)=>!v);
        if (emytyInput) {
            logError(t("app.errorMessage.valueOfVarRequired"));
            return false;
        }
        return true;
    };
    const [controlFocus, setControlFocus] = (0,react_.useState)(0);
    const [openingSuggestedQuestions, setOpeningSuggestedQuestions] = (0,react_.useState)([]);
    const [messageTaskId, setMessageTaskId] = (0,react_.useState)("");
    const [hasStopResponded, setHasStopResponded, getHasStopResponded] = (0,lib/* useGetState */.$k)(false);
    const [isResponsingConIsCurrCon, setIsResponsingConCurrCon, getIsResponsingConIsCurrCon] = (0,lib/* useGetState */.$k)(true);
    const [userQuery, setUserQuery] = (0,react_.useState)("");
    const updateCurrentQA = ({ responseItem , questionId , placeholderAnswerId , questionItem  })=>{
        // closesure new list is outdated.
        const newListWithAnswer = (0,immer_esm/* default */.ZP)(getChatList().filter((item)=>item.id !== responseItem.id && item.id !== placeholderAnswerId), (draft)=>{
            if (!draft.find((item)=>item.id === questionId)) draft.push({
                ...questionItem
            });
            draft.push({
                ...responseItem
            });
        });
        setChatList(newListWithAnswer);
    };
    const handleSend = async (message, files)=>{
        if (isResponsing) {
            notify({
                type: "info",
                message: t("app.errorMessage.waitForResponse")
            });
            return;
        }
        const data = {
            inputs: currInputs,
            query: message,
            conversation_id: isNewConversation ? null : currConversationId
        };
        if (visionConfig?.enabled && files && files?.length > 0) {
            data.files = files.map((item)=>{
                if (item.transfer_method === TransferMethod.local_file) {
                    return {
                        ...item,
                        url: ""
                    };
                }
                return item;
            });
        }
        // qustion
        const questionId = `question-${Date.now()}`;
        const questionItem = {
            id: questionId,
            content: message,
            isAnswer: false,
            message_files: files
        };
        const placeholderAnswerId = `answer-placeholder-${Date.now()}`;
        const placeholderAnswerItem = {
            id: placeholderAnswerId,
            content: "",
            isAnswer: true
        };
        const newList = [
            ...getChatList(),
            questionItem,
            placeholderAnswerItem
        ];
        setChatList(newList);
        let isAgentMode = false;
        // answer
        const responseItem = {
            id: `${Date.now()}`,
            content: "",
            agent_thoughts: [],
            message_files: [],
            isAnswer: true
        };
        let hasSetResponseId = false;
        const prevTempNewConversationId = getCurrConversationId() || "-1";
        let tempNewConversationId = "";
        setResponsingTrue();
        sendChatMessage(data, {
            getAbortController: (abortController)=>{
                setAbortController(abortController);
            },
            onData: (message, isFirstMessage, { conversationId: newConversationId , messageId , taskId  })=>{
                if (!isAgentMode) {
                    responseItem.content = responseItem.content + message;
                } else {
                    const lastThought = responseItem.agent_thoughts?.[responseItem.agent_thoughts?.length - 1];
                    if (lastThought) lastThought.thought = lastThought.thought + message // need immer setAutoFreeze
                    ;
                }
                if (messageId && !hasSetResponseId) {
                    responseItem.id = messageId;
                    hasSetResponseId = true;
                }
                if (isFirstMessage && newConversationId) tempNewConversationId = newConversationId;
                setMessageTaskId(taskId);
                // has switched to other conversation
                if (prevTempNewConversationId !== getCurrConversationId()) {
                    setIsResponsingConCurrCon(false);
                    return;
                }
                updateCurrentQA({
                    responseItem,
                    questionId,
                    placeholderAnswerId,
                    questionItem
                });
            },
            async onCompleted (hasError) {
                if (hasError) return;
                if (getConversationIdChangeBecauseOfNew()) {
                    const { data: allConversations  } = await fetchConversations();
                    const newItem = await generationConversationName(allConversations[0].id);
                    const newAllConversations = (0,immer_esm/* default */.ZP)(allConversations, (draft)=>{
                        draft[0].name = newItem.name;
                    });
                    setConversationList(newAllConversations);
                }
                setConversationIdChangeBecauseOfNew(false);
                resetNewConversationInputs();
                setChatNotStarted();
                setCurrConversationId(tempNewConversationId, APP_ID, true);
                setResponsingFalse();
            },
            onFile (file) {
                const lastThought = responseItem.agent_thoughts?.[responseItem.agent_thoughts?.length - 1];
                if (lastThought) lastThought.message_files = [
                    ...lastThought.message_files,
                    {
                        ...file
                    }
                ];
                updateCurrentQA({
                    responseItem,
                    questionId,
                    placeholderAnswerId,
                    questionItem
                });
            },
            onThought (thought) {
                isAgentMode = true;
                const response = responseItem;
                if (thought.message_id && !hasSetResponseId) {
                    response.id = thought.message_id;
                    hasSetResponseId = true;
                }
                // responseItem.id = thought.message_id;
                if (response.agent_thoughts.length === 0) {
                    response.agent_thoughts.push(thought);
                } else {
                    const lastThought = response.agent_thoughts[response.agent_thoughts.length - 1];
                    // thought changed but still the same thought, so update.
                    if (lastThought.id === thought.id) {
                        thought.thought = lastThought.thought;
                        thought.message_files = lastThought.message_files;
                        responseItem.agent_thoughts[response.agent_thoughts.length - 1] = thought;
                    } else {
                        responseItem.agent_thoughts.push(thought);
                    }
                }
                // has switched to other conversation
                if (prevTempNewConversationId !== getCurrConversationId()) {
                    setIsResponsingConCurrCon(false);
                    return false;
                }
                updateCurrentQA({
                    responseItem,
                    questionId,
                    placeholderAnswerId,
                    questionItem
                });
            },
            onMessageEnd: (messageEnd)=>{
                if (messageEnd.metadata?.annotation_reply) {
                    responseItem.id = messageEnd.id;
                    responseItem.annotation = {
                        id: messageEnd.metadata.annotation_reply.id,
                        authorName: messageEnd.metadata.annotation_reply.account.name
                    };
                    const newListWithAnswer = (0,immer_esm/* default */.ZP)(getChatList().filter((item)=>item.id !== responseItem.id && item.id !== placeholderAnswerId), (draft)=>{
                        if (!draft.find((item)=>item.id === questionId)) draft.push({
                            ...questionItem
                        });
                        draft.push({
                            ...responseItem
                        });
                    });
                    setChatList(newListWithAnswer);
                    return;
                }
                // not support show citation
                // responseItem.citation = messageEnd.retriever_resources
                const newListWithAnswer = (0,immer_esm/* default */.ZP)(getChatList().filter((item)=>item.id !== responseItem.id && item.id !== placeholderAnswerId), (draft)=>{
                    if (!draft.find((item)=>item.id === questionId)) draft.push({
                        ...questionItem
                    });
                    draft.push({
                        ...responseItem
                    });
                });
                setChatList(newListWithAnswer);
            },
            onMessageReplace: (messageReplace)=>{
                setChatList((0,immer_esm/* default */.ZP)(getChatList(), (draft)=>{
                    const current = draft.find((item)=>item.id === messageReplace.id);
                    if (current) current.content = messageReplace.answer;
                }));
            },
            onError () {
                setResponsingFalse();
                // role back placeholder answer
                setChatList((0,immer_esm/* default */.ZP)(getChatList(), (draft)=>{
                    draft.splice(draft.findIndex((item)=>item.id === placeholderAnswerId), 1);
                }));
            }
        });
    };
    const handleFeedback = async (messageId, feedback)=>{
        await updateFeedback({
            url: `/messages/${messageId}/feedbacks`,
            body: {
                rating: feedback.rating
            }
        });
        const newChatList = chatList.map((item)=>{
            if (item.id === messageId) {
                return {
                    ...item,
                    feedback
                };
            }
            return item;
        });
        setChatList(newChatList);
        notify({
            type: "success",
            message: t("common.api.success")
        });
    };
    const renderSidebar = ()=>{
        if (!APP_ID || !APP_INFO || !promptConfig) return null;
        return /*#__PURE__*/ jsx_runtime_.jsx(sidebar, {
            list: conversationList,
            onCurrentIdChange: handleConversationIdChange,
            currentId: currConversationId,
            copyRight: APP_INFO.copyright || APP_INFO.title
        });
    };
    if (appUnavailable) {
        return /*#__PURE__*/ jsx_runtime_.jsx(app_unavailable, {
            isUnknwonReason: isUnknwonReason,
            errMessage: !hasSetAppConfig ? "Please set APP_ID and API_KEY in config/index.tsx" : ""
        });
    }
    if (!APP_ID || !APP_INFO || !promptConfig) return /*#__PURE__*/ jsx_runtime_.jsx(loading, {
        type: "app"
    });
    return /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
        className: "bg-gray-100",
        children: [
            /*#__PURE__*/ jsx_runtime_.jsx(header, {
                title: APP_INFO.title,
                isMobile: isMobile,
                onShowSideBar: showSidebar,
                onCreateNewChat: ()=>handleConversationIdChange("-1")
            }),
            /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                className: "flex rounded-t-2xl bg-white overflow-hidden",
                children: [
                    !isMobile && renderSidebar(),
                    isMobile && isShowSidebar && /*#__PURE__*/ jsx_runtime_.jsx("div", {
                        className: "fixed inset-0 z-50",
                        style: {
                            backgroundColor: "rgba(35, 56, 118, 0.2)"
                        },
                        onClick: hideSidebar,
                        children: /*#__PURE__*/ jsx_runtime_.jsx("div", {
                            className: "inline-block",
                            onClick: (e)=>e.stopPropagation(),
                            children: renderSidebar()
                        })
                    }),
                    /*#__PURE__*/ (0,jsx_runtime_.jsxs)("div", {
                        className: "flex-grow flex flex-col h-[calc(100vh_-_3rem)] overflow-y-auto",
                        children: [
                            /*#__PURE__*/ jsx_runtime_.jsx(config_scence, {
                                conversationName: conversationName,
                                hasSetInputs: hasSetInputs,
                                isPublicVersion: isShowPrompt,
                                siteInfo: APP_INFO,
                                promptConfig: promptConfig,
                                onStartChat: handleStartChat,
                                canEidtInpus: canEditInpus,
                                savedInputs: currInputs,
                                onInputsChange: setCurrInputs
                            }),
                            hasSetInputs && /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                className: "relative grow h-[200px] pc:w-[794px] max-w-full mobile:w-full pb-[66px] mx-auto mb-3.5 overflow-hidden",
                                children: /*#__PURE__*/ jsx_runtime_.jsx("div", {
                                    className: "h-full overflow-y-auto",
                                    ref: chatListDomRef,
                                    children: /*#__PURE__*/ jsx_runtime_.jsx(chat, {
                                        chatList: chatList,
                                        onSend: handleSend,
                                        onFeedback: handleFeedback,
                                        isResponsing: isResponsing,
                                        checkCanSend: checkCanSend,
                                        visionConfig: visionConfig
                                    })
                                })
                            })
                        ]
                    })
                ]
            })
        ]
    });
};
/* harmony default export */ const components = (/*#__PURE__*/react_default().memo(Main));


/***/ }),

/***/ 89322:
/***/ ((module) => {

// Exports
module.exports = {
	"appIcon": "style_appIcon__G5ePF",
	"large": "style_large__n_DE8",
	"small": "style_small__S2FSo",
	"xs": "style_xs__eJYKU",
	"tiny": "style_tiny__qqPS4",
	"rounded": "style_rounded__sJ5kM"
};


/***/ }),

/***/ 22749:
/***/ ((module) => {

// Exports
module.exports = {
	"item": "style_item__iswpu",
	"img-2": "style_img-2__Nn6NI",
	"img-4": "style_img-4__46STa"
};


/***/ }),

/***/ 51898:
/***/ ((module) => {

// Exports
module.exports = {
	"dot-flashing": "style_dot-flashing__BKXc3",
	"text": "style_text___m3NV",
	"avatar": "style_avatar__nq0IG",
	"dot-flashing-avatar": "style_dot-flashing-avatar__N4gVo"
};


/***/ }),

/***/ 20190:
/***/ ((module) => {

// Exports
module.exports = {
	"answerIcon": "style_answerIcon__PjZle",
	"typeingIcon": "style_typeingIcon__D3MOH",
	"questionIcon": "style_questionIcon__vmwTr",
	"answer": "style_answer__BBg2K",
	"question": "style_question__8cWai",
	"answerWrap": "style_answerWrap__Yu2nN",
	"itemOperation": "style_itemOperation__mnZtG",
	"textArea": "style_textArea__ia_QD",
	"count": "style_count__40F_r",
	"sendBtn": "style_sendBtn__7Zif5"
};


/***/ }),

/***/ 16269:
/***/ ((module) => {

// Exports
module.exports = {
	"boxShodow": "style_boxShodow__ZKBoi"
};


/***/ }),

/***/ 11634:
/***/ ((module) => {

// Exports
module.exports = {
	"boxShodow": "style_boxShodow__I_wtB",
	"bgGrayColor": "style_bgGrayColor__porcw",
	"headerBg": "style_headerBg__4w97U",
	"formLabel": "style_formLabel__e7YiO",
	"customBtn": "style_customBtn__em5f5",
	"logo": "style_logo__s2JXK"
};


/***/ }),

/***/ 93429:
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

/* eslint-disable @typescript-eslint/no-use-before-define */ /* __next_internal_client_entry_do_not_use__  auto */ const { createProxy  } = __webpack_require__(35985);
module.exports = createProxy("C:\\Users\\Dorothy\\Documents\\GitHub\\dify\\webapp\\app\\components\\index.tsx");


/***/ }),

/***/ 70546:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ layout)
});

// EXTERNAL MODULE: external "next/dist/compiled/react/jsx-runtime"
var jsx_runtime_ = __webpack_require__(56786);
// EXTERNAL MODULE: ./node_modules/next/headers.js
var headers = __webpack_require__(68558);
// EXTERNAL MODULE: ./node_modules/negotiator/index.js
var negotiator = __webpack_require__(46241);
var negotiator_default = /*#__PURE__*/__webpack_require__.n(negotiator);
// EXTERNAL MODULE: ./node_modules/@formatjs/intl-localematcher/index.js
var intl_localematcher = __webpack_require__(90019);
;// CONCATENATED MODULE: ./i18n/index.ts
const i18n = {
    defaultLocale: "en",
    locales: [
        "en",
        "zh-Hans"
    ]
};

;// CONCATENATED MODULE: ./i18n/server.ts





const getLocaleOnServer = ()=>{
    // @ts-expect-error locales are readonly
    const locales = i18n.locales;
    let languages;
    // get locale from cookie
    const localeCookie = (0,headers.cookies)().get("locale");
    languages = localeCookie?.value ? [
        localeCookie.value
    ] : [];
    if (!languages.length) {
        // Negotiator expects plain object so we need to transform headers
        const negotiatorHeaders = {};
        (0,headers.headers)().forEach((value, key)=>negotiatorHeaders[key] = value);
        // Use negotiator and intl-localematcher to get best locale
        languages = new (negotiator_default())({
            headers: negotiatorHeaders
        }).languages();
    }
    // match locale
    const matchedLocale = (0,intl_localematcher/* match */.EQ)(languages, locales, i18n.defaultLocale);
    return matchedLocale;
};

// EXTERNAL MODULE: ./app/styles/globals.css
var globals = __webpack_require__(70539);
// EXTERNAL MODULE: ./app/styles/markdown.scss
var markdown = __webpack_require__(65322);
;// CONCATENATED MODULE: ./app/layout.tsx




const LocaleLayout = ({ children  })=>{
    const locale = getLocaleOnServer();
    return /*#__PURE__*/ jsx_runtime_.jsx("html", {
        lang: locale ?? "en",
        className: "h-full",
        children: /*#__PURE__*/ jsx_runtime_.jsx("body", {
            className: "h-full",
            children: /*#__PURE__*/ jsx_runtime_.jsx("div", {
                className: "overflow-x-auto",
                children: /*#__PURE__*/ jsx_runtime_.jsx("div", {
                    className: "w-screen h-screen min-w-[300px]",
                    children: children
                })
            })
        })
    });
};
/* harmony default export */ const layout = (LocaleLayout);


/***/ }),

/***/ 16594:
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(56786);
/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(34212);
/* harmony import */ var _app_components__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(93429);
/* harmony import */ var _app_components__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_app_components__WEBPACK_IMPORTED_MODULE_2__);



const App = ({ params  })=>{
    return /*#__PURE__*/ react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx((_app_components__WEBPACK_IMPORTED_MODULE_2___default()), {
        params: params
    });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1__.memo(App));


/***/ }),

/***/ 72699:
/***/ (() => {



/***/ }),

/***/ 70539:
/***/ (() => {



/***/ }),

/***/ 65322:
/***/ (() => {



/***/ })

};
;

// load runtime
var __webpack_require__ = require("../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, [904,284], () => (__webpack_exec__(20821)));
module.exports = __webpack_exports__;

})();